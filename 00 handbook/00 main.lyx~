#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass report
\begin_preamble


\usepackage[colorinlistoftodos]{todonotes}
\usepackage{placeins}
\usepackage{parskip}



\usepackage{subcaption}
\usepackage{tikz}


% for tables: \toprule, \midrule, \bottomrule
\usepackage{array}% for tables: \bfseries

\usepackage{amssymb}


\usepackage{graphicx}

\usepackage{booktabs}
\newcommand{\otoprule}{\midrule[\heavyrulewidth]}

\usepackage{pdflscape}
\usepackage{bbding}
\usepackage{pifont}
\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding utf8
\fontencoding default
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks false
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref section
\pdf_pdfusetitle false
\papersize a4paper
\use_geometry false
\use_package amsmath 2
\use_package amssymb 0
\use_package cancel 0
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 0
\use_package mhchem 0
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style harvard
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 2
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 3cm*
\end_inset


\end_layout

\begin_layout Standard
\align center

\size largest
Marine cybernetics
\end_layout

\begin_layout Standard
\align center

\size largest
laboratory handbook 
\end_layout

\begin_layout Standard
\align left
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard
\align left
\begin_inset Graphics
	filename NTNU_logo.eps
	scale 60

\end_inset


\end_layout

\begin_layout Standard
Faculty of Engineering Science and Technology
\begin_inset Newline newline
\end_inset

Department of Marine Technology
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\begin_inset VSpace 3cm*
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagenumbering{roman}
\backslash
setcounter{page}{1}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace 3cm*
\end_inset


\end_layout

\begin_layout Section*
Introduction
\end_layout

\begin_layout Standard
This handbook is a comprehensive reference for the marine cybernetics laboratory.
 The laboratory is used in teaching and research on development and real-time
 testing of marine control systems.
\end_layout

\begin_layout Section*
Structure
\end_layout

\begin_layout Standard
Part 
\begin_inset CommandInset ref
LatexCommand ref
reference "part: Theory"

\end_inset

 explains the concepts and motivations for the stepwise controller development.
\end_layout

\begin_layout Standard
Part 
\begin_inset CommandInset ref
LatexCommand ref
reference "part: Laboratory user guide"

\end_inset

 is a user guide intended for users of the laboratory.
 Step-by-step instructions for development and deployment of programs to
 the real-time controller are given.
\end_layout

\begin_layout Standard
Lower level details, intended for laboratory assistants and customized use,
 are given in Part 
\begin_inset CommandInset ref
LatexCommand ref
reference "part: Equipment setup and configuration"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\begin_inset CommandInset nomencl_print
LatexCommand printnomenclature
set_width "auto"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "BT"
description "bow thruster"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "cRIO"
description "compact reconfigurable input/output real-time embedded industrial controller by National Instruments"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "CS"
description "cybership ship prefix"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "CSE1"
description "CS Enterprise I"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "CSS"
description "CS Saucer"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "DP"
description "dynamic positioning"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "ESC"
description "electronic speed controller"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "FPGA"
description "field-programmable gate array"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "HIL"
description "hardware-in-the-loop"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "IO"
description "input/output"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "MC Lab"
description "marine cybernetics laboratory"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "PWM"
description "pulse-width modulation"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "RPi"
description "Raspberry Pi single-board computer"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "VSP"
description "Voith Schneider propeller"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "VI"
description "virtual instrument, a LabVIEW program"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagenumbering{arabic}
\end_layout

\end_inset


\end_layout

\begin_layout Part
\begin_inset CommandInset label
LatexCommand label
name "part: Theory"

\end_inset

Introduction
\end_layout

\begin_layout Chapter
Marine cybernetics laboratory
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename mc_lab.png
	width 95text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Marine cybernetics laboratory basin-1"

\end_inset

Marine cybernetics laboratory basin
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "towing-1"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The laboratory is equipped for experimental testing of marine control systems
 and hydrodynamic tests.
 It consists of a wave basin with an advanced instrumentation package and
 a towing carriage.
 The basin, depicted in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Marine cybernetics laboratory basin-1"

\end_inset

, has dimensions 40m x 6.45m x 1.5m (LxBxD).
\end_layout

\begin_layout Standard
The laboratory gives tangible results that solidifies theoretical work.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
http://www.ntnu.no/imt/lab/cybernetics
\end_layout

\begin_layout Plain Layout
The Marine Cybernetics Laboratory is the newest test basin at the Marine
 Technology Centre.
 It is located in what was originally a storage tank for ship models made
 of paraffin wax.
 
\end_layout

\begin_layout Plain Layout
As the name indicates, the facility is especially suited for tests of marine
 control systems, due to the relatively small size and advanced instrumentation
 package.
 It is also suitable for more specialised hydrodynamic tests, mainly due
 to the advanced towing carriage , which has capability for precise movement
 of models in 6 degrees of freedom.
 
\end_layout

\begin_layout Plain Layout
The MCLab is operated by the Department of Marine Technology, and has been
 a Marie Curie EU Training Site (2002-2008).
 It is mainly used by Master and PhD-students, but it is also available
 for MARINTEK and external users.
 
\end_layout

\begin_layout Plain Layout
The software in use was developed using rapid prototyping techniques and
 automatic code generation under Matlab/Simulink and Opal.
 The target PC onboard the vessel runs the QNX real-time operating system
 while experimental results are presented in real-time on a host PC using
 Labview.
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
todo{Sakset rett fra nettsiden http://www.ntnu.edu/imt/marine-cybernetics-lab}
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Fixed Equipment
\end_layout

\begin_layout Subsection
Qualisys motion capture system
\end_layout

\begin_layout Standard
Qualisys provides 6 degrees of freedom data tracking.
 The system has millimeter precision, works in real time and is configured
 to 50Hz.
\end_layout

\begin_layout Standard
The positioning system consists of three Oqus high speed infrared cameras
 registering infrared reflectors placed on the vessel.
 Peer-to-peer (P2P) networking is used to transmit camera data to a dedicated
 computer running Qualisys Track Manager (QTM) software.
 QTM performs triangulation and broadcasts the vessel position over the
 wireless network.
\end_layout

\begin_layout Subsection
Towing carriage
\end_layout

\begin_layout Standard
The carriage runs at speeds up to 2m/s.
 It also has capability for precise movement of models in 6 degrees of freedom
 and is thus suitable for more specialized hydrodynamic tests.
\end_layout

\begin_layout Subsection
Wave generator
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features rotate="0" tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Height [m]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Period T [s]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Regular waves
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $H<0.25$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.3 - 3.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Irregular waves
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
\begin_inset Formula $H_{s}<0.15$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.6 - 1.5
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Wave generator capacity-1"

\end_inset

Wave generator capacity
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The single paddle wave generator is controlled by a dedicated computer.
 Available spectrum are first order Stoke, JONSWAP, Pierson-Moskowitz, Bretschne
ider, ISSC and ITTC.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Wave generator capacity-1"

\end_inset

 summarizes the generation capacity.
\end_layout

\begin_layout Subsection
Current generator
\end_layout

\begin_layout Standard
Not available as of spring 2015.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Vessels
\end_layout

\begin_layout Standard
Several both surface and underwater vessels are used in the MC Lab.
\end_layout

\begin_layout Standard
The cyber ship class, with ship prefix CS, consists of 6 vessels:
\end_layout

\begin_layout Itemize
CS Inocean Cat I Arctic Drillship,
\end_layout

\begin_layout Itemize
CS Saucer,
\end_layout

\begin_layout Itemize
CS Enterprise I,
\end_layout

\begin_layout Itemize
Cybership III,
\end_layout

\begin_layout Itemize
Cybership II, and
\end_layout

\begin_layout Itemize
Cybership I.
\end_layout

\begin_layout Standard
Also, there laboratory holds an underwater craft,
\end_layout

\begin_layout Itemize
ROV Neptunus,
\end_layout

\begin_layout Standard
and a semi submersible drilling rig
\end_layout

\begin_layout Itemize
CyberRig.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
CS Inocean Cat I Arctic Drillship
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
todo{
\end_layout

\end_inset

Add material from Jon
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
CS Saucer
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename CSSaucer.png
	width 95text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CS Saucer"

\end_inset

CS Saucer
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
CS Saucer is a fully actuated and highly controllable vessel with a spherically
 shaped hull, much like a flying saucer.
 It is designed to be light weight, agile and very responsive.
 The CS Saucer adds possibilities for rapid response and motion in surge
 and sway, something that is difficult to obtain with a traditional ship
 hull.
 
\end_layout

\begin_layout Standard
The non conventional shape of the hull of such a marine vessel opens the
 possibilities for original projects in control theory and hydrodynamics,
 as well as serving as a platform where student can get experience with
 the practical aspects of control systems implementation
\end_layout

\begin_layout Subsubsection
Hull
\end_layout

\begin_layout Standard
The hull is constructed from three millimeter MDF sheeting, milled Divinycell
 foam and a woven carbon with epoxy.
 This results in a rigid hull with low draft.
 The vessel has a detachable lid made of Plexiglas which is secured to the
 top of the vessel with four butterfly screws.
\end_layout

\begin_layout Subsubsection
Control system
\end_layout

\begin_layout Standard
The embedded controller myRIO from National Instruments is used to control
 the vessel.
 The myRIO with its default FPGA personality is capable of driving 8 PWM
 signals simultaneously, in addition to multiple digital and analog connections.
 
\end_layout

\begin_layout Standard
Marine 30 Electronic Speed Controllers (ESC) are used to control the DC
 motors driving the thruster propellers.
\end_layout

\begin_layout Subsubsection
Actuators
\end_layout

\begin_layout Standard
The vessel is fitted with three Graupner Schottel drive unit II azimuth
 thrusters.
 Torpedo 800 brushed DC motors drive the propeller.
 Graupner DS8311 servo motors are used to control the angle of the thrusters.
\end_layout

\begin_layout Subsubsection
Power
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename CSSaucer_power.png
	width 95text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CS Saucer power"

\end_inset

CS Saucer power system
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The system is powered by a three cell 11.1V Lithium Polymer battery, as seen
 in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: CS Saucer power"

\end_inset


\end_layout

\begin_layout Standard
In order to convert the 11.1V power provided by the battery to 5V for the
 servos, a switching DC/DC converter is user together with a capacitor.
\end_layout

\begin_layout Subsubsection
Literature
\end_layout

\begin_layout Paragraph
Specialization projects and master theses
\end_layout

\begin_layout Itemize
Marine Cybernetics Vessel CS Saucer: Design, construction and control 
\begin_inset CommandInset citation
LatexCommand citep
key "Idland2015"

\end_inset


\end_layout

\begin_layout Itemize
Rotem Sharoni, 2016
\end_layout

\begin_layout Itemize
Einar Skiftestad Ueland, 2016
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
ROV Neptunus
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename ROVNeptunus_1.png
	width 40text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: ROV Neptunus"

\end_inset

ROV Neptunus
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Neptunus is a small, low-cost ROV prototype.
 The design is based on OpenROV, and the instrumentation is directly adapted
 thence.
\end_layout

\begin_layout Subsubsection
Hull
\end_layout

\begin_layout Standard
Neptunus is designed with a foil shaped body, in order to induce low drag
 forces in the longitudinal direction.
 The prototype consists of several blocks, made of acrylonitrile butadiene
 styrene (ABS) - plastic, 3D printed at NTNU.
\end_layout

\begin_layout Subsubsection
Actuators
\end_layout

\begin_layout Standard
There are three thrusters on Neptunus: two in the longitudinal direction,
 and one in the vertical.
\end_layout

\begin_layout Subsubsection
Control system
\end_layout

\begin_layout Standard
The main processes are driven by a BeagleBone computer, and an Arduino control
 board.
 It is equipped with an inertial measurement unit (IMU) and a high definition
 (HD) web camera.
\end_layout

\begin_layout Subsubsection
Literature
\end_layout

\begin_layout Paragraph
Specialization projects and master theses
\end_layout

\begin_layout Itemize
Low cost ROV design, based on testing, simulations and analysis of OpenROV
\begin_inset CommandInset citation
LatexCommand citep
key "FollestadSandvedValle2014"

\end_inset


\end_layout

\begin_layout Itemize
Design and Implementation of Software for the ROV Neptunus 
\begin_inset CommandInset citation
LatexCommand citep
key "Munz2015"

\end_inset


\end_layout

\begin_layout Itemize
Remote Control and Automatic Path-following for C/S Enterprise I and ROV
 Neptunus 
\begin_inset CommandInset citation
LatexCommand citep
key "Sandved2015"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
CS Enterprise I
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename CSE1_2.PNG
	width 95text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Cybership Enterprise 1"

\end_inset

CS Enterprise I
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The CSE1, depicted in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Cybership Enterprise 1"

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
todo{
\end_layout

\end_inset

hva bruker vi den til
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The vessel CS Enterprise I was constructed as a model ship available to
 master and PhD students at NTNU [Skatun, 2011].
 The work performed on CS Enterprise I include, but is not limited to, dynamic
 positioning systems, maneuvering systems and path following, and navigation
 with virtual reality [Valle, 2015].
\end_layout

\begin_layout Subsubsection
Hull
\end_layout

\begin_layout Standard
tug boat model.
\end_layout

\begin_layout Subsubsection
Actuators
\end_layout

\begin_layout Standard
The ship is fitted with two Voith Schneider propellers (VSP) astern and
 a bow thruster (BT).
\end_layout

\begin_layout Subsubsection
Control system
\end_layout

\begin_layout Standard
The on-board control system consists of
\end_layout

\begin_layout Itemize
a National Instruments compact reconfigurable input/output (cRIO) embedded
 controller,
\end_layout

\begin_layout Itemize
a Raspberry Pi (RPi) single-board computer,
\end_layout

\begin_layout Itemize
three electronic speed controllers (ESC), and
\end_layout

\begin_layout Itemize
four servos.
\end_layout

\begin_layout Standard
The operator interfaces the system by
\end_layout

\begin_layout Itemize
laptop, and
\end_layout

\begin_layout Itemize
a Sony Sixaxis wireless gamepad for PlayStation 3.
\end_layout

\begin_layout Paragraph
High-level communication
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename setupCSE1.jpg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CSE1 communication"

\end_inset

CSE1 communication diagram
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename CSE1 signal.png
	height 40pheight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CSE1 signal"

\end_inset

CSE1 signal paths
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Following Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: CSE1 communication"

\end_inset

 from left to right:
\end_layout

\begin_layout Description
Sixaxis transmits its information to the RPi Bluetooth USB dongle with which
 it is previously paired
\begin_inset Foot
status open

\begin_layout Plain Layout
One-time pairing procedure described in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "par: Bluetooth-pairing"

\end_inset

.
\end_layout

\end_inset

.
\end_layout

\begin_layout Description
RPi receives Sixaxis data through the USB dongle and forwards it through
 its TCP/IP
\begin_inset Foot
status open

\begin_layout Plain Layout
All IP addresses are as given in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: IP addresses"

\end_inset

.
\end_layout

\end_inset

 server over Ethernet to the cRIO.
\end_layout

\begin_layout Description
cRIO reads QTM broadcast positioning data through the Wi-Fi bridge on Ethernet
 port 1, Sixaxis data on Ethernet port 2.
 Online data and laptop input is transmitted and received on Ethernet port
 1 by the VeriStand Engine.
\end_layout

\begin_layout Description
Laptop reads simulation data and sends input to the cRIO over Ethernet.
\end_layout

\begin_layout Paragraph
Low-level communication
\end_layout

\begin_layout Standard
The BT and VSP motor speeds are controlled by ESC.
 The ESC receive their setpoints as a pulse-width modulated (PWM) signals
 from the cRIO digital output module.
\end_layout

\begin_layout Standard
The VSP blade pitches are controlled by servos.
 The servos also receive their setpoint as PWM signals.
\end_layout

\begin_layout Paragraph
Software
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename CSE1_ctrl_software.gif
	height 60text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CSE1 software"

\end_inset

CSE1 control software
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The software supports four different control modes, as seen in the middle
 of Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: CSE1 software"

\end_inset

:
\end_layout

\begin_layout Itemize
Individual actuator control allows controlling the force 
\begin_inset Formula $u$
\end_inset

, angular velocity 
\begin_inset Formula $\omega$
\end_inset

 and angle 
\begin_inset Formula $\alpha$
\end_inset

 each thruster
\end_layout

\begin_layout Itemize
Generalized force control facilitates inputting desired surge and sway forces
 and yaw moment, 
\begin_inset Formula $X$
\end_inset

, 
\begin_inset Formula $Y$
\end_inset

, 
\begin_inset Formula $N$
\end_inset

, respectively.
\end_layout

\begin_layout Itemize
The user defined custom control
\end_layout

\begin_layout Itemize
Stationkeeping.
\end_layout

\begin_layout Standard
The two first modes only take the joystick signal as input.
\end_layout

\begin_layout Standard
The two latter modes take the position measurement 
\begin_inset Formula $\eta_{\text{QTM}}$
\end_inset

 from QTM.
 This signal is in turn converted meters and radians.
 Finally, measurement noise may be added to get the measured signal 
\begin_inset Formula $\eta_{m}$
\end_inset

.
\end_layout

\begin_layout Standard
The control modes output the desired output vector 
\begin_inset Formula $u_{d}$
\end_inset

.
 The actual output 
\begin_inset Formula $u$
\end_inset

 may differ due to mechanical and electrical dynamics.
\end_layout

\begin_layout Standard
Finally, the output is converted to pwm signals outputted through the digital
 input/output (DIO) port.
\end_layout

\begin_layout Subsubsection
Power
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename CSE1 power.png
	height 40pheight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CSE1 power"

\end_inset

CSE1 power system
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: CSE1 power"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Literature
\end_layout

\begin_layout Paragraph
Journals and conferences
\end_layout

\begin_layout Itemize
LOS guidance for towing an iceberg along a straight-line path 
\begin_inset CommandInset citation
LatexCommand citep
key "OrstenNorgrenSkjetne2014"

\end_inset


\end_layout

\begin_layout Paragraph
Specialization projects and master theses
\end_layout

\begin_layout Itemize
Development of a DP system for CS Enterprise I with Voith Schneider thrusters.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Skaatun2011"

\end_inset


\end_layout

\begin_layout Itemize
Development of a modularized control architecture for CS Enterprise I for
 path-following based on LOS and maneuvering theory 
\begin_inset CommandInset citation
LatexCommand citep
key "Tran2013"

\end_inset


\end_layout

\begin_layout Itemize
Automatic Reliability-based Control of Iceberg Towing in Open Waters 
\begin_inset CommandInset citation
LatexCommand citep
key "Orsten2014"

\end_inset


\end_layout

\begin_layout Itemize
Line-Of-Sight-based maneuvering control design, implementation, and experimental
 testing for the model ship C/S Enterprise I.
\begin_inset CommandInset citation
LatexCommand citep
key "Tran2014"

\end_inset


\end_layout

\begin_layout Itemize
Remote Control and Automatic Path-following for C/S Enterprise I and ROV
 Neptunus 
\begin_inset CommandInset citation
LatexCommand citep
key "Sandved2015"

\end_inset


\end_layout

\begin_layout Itemize
Marine Telepresence System 
\begin_inset CommandInset citation
LatexCommand citep
key "Valle2015"

\end_inset


\end_layout

\begin_layout Itemize
Elias Bjørne, 2016
\end_layout

\begin_layout Paragraph
Other
\end_layout

\begin_layout Itemize
YouTube video 
\begin_inset CommandInset citation
LatexCommand citep
key "Skaatun2014"

\end_inset


\end_layout

\begin_layout Subsubsection
Further development
\end_layout

\begin_layout Itemize
Implement “fail to zero” for communication breakdown
\end_layout

\begin_layout Itemize
Add IMU or gyro
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Cybership III
\end_layout

\begin_layout Standard
1:30 scale model of a supply vessel.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Cybership II
\end_layout

\begin_layout Standard
2001.
 1:70 scaled model of a supply vessel.
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Cybership I
\end_layout

\begin_layout Standard
1:70 scaled model of a supply vessel.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
CyberRig
\end_layout

\begin_layout Standard
The CyberRig is a semi submersible 1:100 scaled model drilling rig used
 in student projects and research [Bjrneset, 2014].
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Our Lass II model
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename ourlass.png
	width 95text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Our Lass II"

\end_inset

Our Lass II
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
1:24 scaled model of a fishing vessel
\end_layout

\begin_layout Subsubsection
Literature
\end_layout

\begin_layout Paragraph
Journals and conferences
\end_layout

\begin_layout Itemize
Online Estimation of Ship’s Mass and Center of Mass Using Inertial Measurements
 
\begin_inset CommandInset citation
LatexCommand citep
key "LinderEnqvistFossenJohansenGustafsson2015"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
Control system development philosophy
\end_layout

\begin_layout Standard
As the complexity of marine vessels and operations grows, the need for thorough
 testing and verification of the vessel real-time control and monitoring
 systems increases.
 More advanced integrated functionality relies on many separately designed
 control and monitoring systems to cooperate on performing common tasks.
 Regular software simulations cannot cover all aspects of this complexity.
\end_layout

\begin_layout Standard
Through steps-wise verification and validation at different levels of fidelity,
 errors can be discovered at earlier stages thus lowering the total development
 cost.
\end_layout

\begin_layout Standard
In the case of the MC Lab, users qualify their experimental setups before
 the assigned laboratory time.
 This reduces debugging time, improves tuning of parameters and test scenarios,
 thereby increasing efficiency and maximizing the outcome of the experimental
 work.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Smogeli, Fremtidens verifikasjon av kontrollsystemer for Skip og offshorefartøy
\end_layout

\begin_layout Plain Layout
DNV, Hardware in the Loop Testing (HIL)
\end_layout

\begin_layout Plain Layout
Johansen, Sørensen, Experiences with HIL Simulator Testing of Power Management
 Systems
\end_layout

\begin_layout Plain Layout
Smogeli, Introduction to third- party HIL testing
\end_layout

\begin_layout Plain Layout
Johansen, Fossen, Vik, Hardware-in-the-loop Testing of DP systems
\end_layout

\begin_layout Plain Layout
Pivano, Experiences from seven years of DP software testing
\end_layout

\begin_layout Plain Layout
DNV, Rules for Classification of Ships (Part 6, Ch 22)
\end_layout

\begin_layout Plain Layout
Ambrosovskaya, Approach for Advanced Testing of DP Control System
\end_layout

\begin_layout Plain Layout
Selvam, System Verification Helps Validate Complex Integrated Systems
\end_layout

\begin_layout Plain Layout
A.
 Veksler prøveforelesning:
\end_layout

\begin_layout Itemize
Can be seen as something in between simulation testing and full scale testing
\end_layout

\begin_deeper
\begin_layout Itemize
More realistic than a simulation, less realistic than a full-scale testing
\end_layout

\begin_layout Itemize
Mathematical models of the systems that are not included as hardware.
\end_layout

\end_deeper
\begin_layout Itemize
A real-time simulator, constructed by hardware and software, that is
\end_layout

\begin_deeper
\begin_layout Itemize
configured for the control system under consideration
\end_layout

\begin_layout Itemize
embedded in external hardware
\end_layout

\begin_layout Itemize
and interfaced to the target system or component through appropriate I/O
 
\end_layout

\end_deeper
\begin_layout Itemize
Advantages:
\end_layout

\begin_deeper
\begin_layout Itemize
Another layer of independent verification
\end_layout

\begin_layout Itemize
Allows testing emergency procedures that would be too dangerous on a real
 vessel
\end_layout

\end_deeper
\begin_layout Itemize
Disadvantages:
\end_layout

\begin_deeper
\begin_layout Itemize
Initial investment to set up a HIL simulator for a particular system.
 The resources could be spent on simulation testing or full scale testing.
\end_layout

\begin_layout Itemize
Supplements, but does not replace, proper software design techniques
\end_layout

\begin_deeper
\begin_layout Itemize
As with all software testing, it typically executes only a fraction of the
 control system code.
 
\end_layout

\end_deeper
\end_deeper
\begin_layout Plain Layout
Asgeir
\end_layout

\begin_layout Itemize
HIL testing is accomplished by connecting a simulation PC in the system’s
 communication network.
\end_layout

\begin_layout Itemize
Inputs to the equipment under test are simulated.
\end_layout

\begin_layout Itemize
The controllers respond as they would in a dynamic environment.
\end_layout

\begin_layout Itemize
Simulator responds to output from the controllers as the dynamic system
 would
\end_layout

\begin_layout Itemize
Software (core SW and/or configuration) errors are exposed.
\end_layout

\begin_layout Section
Realtime
\end_layout

\begin_layout Plain Layout
Real-time testing involves using a real-time OS as part of a test system.
 The most common requirements driving the need for a real-time test system
 are to achieve greater reliability and performance than is possible using
 a general-purpose OS.
 
\end_layout

\begin_layout Plain Layout
http://www.ni.com/white-paper/3938/en/
\end_layout

\begin_layout Plain Layout
http://www.ni.com/white-paper/14238/en/
\end_layout

\begin_layout Plain Layout
http://www.ni.com/white-paper/13068/en/
\end_layout

\begin_layout Itemize
Forklaring av hva realtime betyr i HW og SW
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Development Steps
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tabular}{lcccc}
\end_layout

\begin_layout Plain Layout


\backslash
toprule%
\end_layout

\begin_layout Plain Layout

DOF      & Controller & Plant   & Iteration time     & Flexibility 
\backslash

\backslash

\end_layout

\begin_layout Plain Layout


\backslash
otoprule
\end_layout

\begin_layout Plain Layout

MIL      & 
\backslash
ding{51} & Extremely short          &           &            
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

SIL      & 
\backslash
ding{51} &           &           &            
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

PIL      &           &           & 
\backslash
ding{51} &            
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

HIL   &           &           &           & 
\backslash
ding{51}  
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

Scale &           &           &           & 
\backslash
ding{51}  
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

Full scale   & 
\backslash
ding{51} & 
\backslash
ding{51} &           &    Low        
\backslash

\backslash

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
bottomrule
\end_layout

\begin_layout Plain Layout


\backslash
end{tabular}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Development steps overview
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Marine cybernetics deals with control engineering for the vessel mechatronic
 systems which again interact with the environment.
 In this section, 
\begin_inset Quotes eld
\end_inset

the controller
\begin_inset Quotes erd
\end_inset

 refers to the designed control software and 
\begin_inset Quotes eld
\end_inset

the plant
\begin_inset Quotes erd
\end_inset

 to the combination of the mechatronic system and the environment.
\end_layout

\begin_layout Subsection
Model-in-the-Loop
\end_layout

\begin_layout Subsubsection
Principle
\end_layout

\begin_layout Standard
A model of the controller interconnected with a physical model of the plant,
 in a control development environment, such as MATLAB Simulink.
\end_layout

\begin_layout Subsubsection
Aim
\end_layout

\begin_layout Standard
Develop control strategies .
 Test principles.
\end_layout

\begin_layout Subsubsection
Iteration time
\end_layout

\begin_layout Standard
Extremely short, small changes are immediately implemented and tested.
\end_layout

\begin_layout Subsubsection
Cost
\end_layout

\begin_layout Standard
Low
\end_layout

\begin_layout Subsection
Software-in-the-Loop
\end_layout

\begin_layout Standard
The controller is coded in the final language, such as C or C++, and connected
 to the plant model in a control development environment.
\end_layout

\begin_layout Subsubsection
Aim
\end_layout

\begin_layout Standard
Test of coding system.
 Reveal coding failures.
\end_layout

\begin_layout Subsubsection
Iteration time
\end_layout

\begin_layout Standard
Slightly longer than MIL.
\end_layout

\begin_layout Subsection
Processor-in-the-Loop
\end_layout

\begin_layout Subsubsection
Principle
\end_layout

\begin_layout Standard
The controller is deployed to a representative microprocessor, connected
 to the plant simulation via high speed bus, such as JTAG.
 The plant must be synchronized with the controller.
\end_layout

\begin_layout Subsubsection
Aim
\end_layout

\begin_layout Standard
Expose problems with execution in the embedded environment, such as insufficient
 computing resources on the embedded processor.
\end_layout

\begin_layout Subsubsection
Iteration time
\end_layout

\begin_layout Standard
Higher, due to the need to regenerate and deploy code for each run.
\end_layout

\begin_layout Subsection
Hardware-in-the-Loop
\end_layout

\begin_layout Subsubsection
Principle
\end_layout

\begin_layout Standard
Controller fully installed into the intended final hardware, connected through
 the plant only through the proper IO.
 The plant simulator must run on a real-time computer emulating the IO of
 a real process.
\end_layout

\begin_layout Subsubsection
Aim
\end_layout

\begin_layout Standard
Perform regulation, security and failure tests without risk.
\end_layout

\begin_layout Standard
Investigate the interaction between subsystems.
\end_layout

\begin_layout Standard
Ensure a high level of robustness and quality.
\end_layout

\begin_layout Subsection
Scale test
\end_layout

\begin_layout Standard
-
\end_layout

\begin_layout Subsection
Full scale
\end_layout

\begin_layout Standard
-
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Recommended Control Modes
\end_layout

\begin_layout Standard
It is favorable to allow for five main control modes:
\end_layout

\begin_layout Itemize
Stop all actuators
\end_layout

\begin_layout Enumerate
Individual actuator control
\end_layout

\begin_layout Enumerate
Generalized force control
\end_layout

\begin_layout Enumerate
Regulation
\end_layout

\begin_layout Enumerate
Operations
\end_layout

\begin_layout Standard
In addition, sub-modes may allow more functionality.
 
\end_layout

\begin_layout Subsection
Individual actuator control
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename ctrl_u.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Individual actuator control"

\end_inset

Individual actuator control
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The most basic mode allows controlling each thruster separately.
 Inputs are typically normalized force 
\begin_inset Formula $u=\left[-1,1\right]$
\end_inset

, angle 
\begin_inset Formula $\alpha=\left[-\pi,\pi\right]$
\end_inset

, and sometimes normalized rotational speed 
\begin_inset Formula $\omega=\left[-1,1\right]$
\end_inset

.
 The software computes the corresponding physical signal, for instance a
 pulse width manipulated (PWM) signal as illustrated in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Individual actuator control"

\end_inset

.
\end_layout

\begin_layout Standard
The user interface may be through gamepad, computer, tablet, etc.
\end_layout

\begin_layout Standard
Implementation details are discussed in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Direct-Thruster-Control"

\end_inset

.
\end_layout

\begin_layout Subsection
Generalized force control
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename ctrl_tau.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Generalized force control"

\end_inset

Generalized force control
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Thrust allocation allows input of the desired generalized force, as seen
 in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Generalized force control"

\end_inset

.
 For six degrees of freedom (6 DOF) control the input is 
\begin_inset Formula 
\[
\tau=\left[\begin{array}{c}
X\\
Y\\
Z\\
K\\
M\\
N
\end{array}\right].
\]

\end_inset

For surface craft, 3 DOF are typically considered: 
\begin_inset Formula 
\[
\tau=\left[\begin{array}{c}
X\\
Y\\
N
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
The user interface may be through gamepad, computer, tablet, etc.
 The appropriate reference frame depends on the application.
\end_layout

\begin_layout Subsubsection
Body frame
\end_layout

\begin_layout Standard
Most commonly, the desired thrust is given in the vessel-fixed body frame.
 This is the intuitive setup for an on-board operator.
\end_layout

\begin_layout Standard
Implementation details are discussed in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Direct-Body-relative-motion"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Inertial frame
\end_layout

\begin_layout Standard
For remote operation, it may be suitable to input the force with regard
 to the inertial frame, rather than the vessel orientation.
\end_layout

\begin_layout Standard
Implementation details are discussed in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Direct-NED-relative-motion"

\end_inset

.
\end_layout

\begin_layout Subsubsection
User frame
\end_layout

\begin_layout Standard
When the operator has eye contact with the vessel, it may be suitable to
 specify the force with respect to the line of sight between the operator
 and craft.
 
\end_layout

\begin_layout Standard
Implementation details are discussed in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Direct-User-relative-motion"

\end_inset

.
\end_layout

\begin_layout Subsection
Regulation
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename ctrl_setpoint.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Regulation"

\end_inset

Regulation
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="7">
<features rotate="0" tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $z$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\phi$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\theta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\psi$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Stationkeeping
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ding{51}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ding{51}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ding{51}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Heading
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ding{51}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Depth
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ding{51}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Roll/Pitch
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ding{51}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ding{51}
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Regulation-modes"

\end_inset

A selection of regulation modes
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Maintaining a given value in one or several DOFs under the influence of
 disturbances is the basic automatic control mode.
 The given value is called setpoint, as illustrated in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Regulation"

\end_inset

.
 Typical sub-modes are listed in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Regulation-modes"

\end_inset

.
 Reference filters for changing setpoints may or may not be included.
\end_layout

\begin_layout Standard
The user interface typically allows inputting the setpoint value directly,
 for instance on a computer or tablet.
 Alternatively, the setpoint may be translated through gamepad.
\end_layout

\begin_layout Standard
Further details are discussed in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Auto-Control"

\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Marine-Operations-Control-1"

\end_inset

Marine Operations Control
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename ctrl_operations.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Marine Operations Control"

\end_inset

Marine Operations Control
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The more complex control modes, typically combined from several of the different
 submodes, give automatic functions that are important for different marine
 operations.
 Input varies depending on the operation.
 It may be maps or waypoints, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Marine Operations Control"

\end_inset

.
\end_layout

\begin_layout Standard
Further details are discussed in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Marine-Operations-Control"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Chapter
Real-time computing
\end_layout

\begin_layout Subsection
Hybrid simulation
\end_layout

\begin_layout Plain Layout
Another advantage of HIL testing is that scenarios that may be difficult
 to test experimentally (either due to the risk involved in the test, due
 to the need for a special state of the environment, or due to inadequate
 experimental facilities), can be tested thoroughly, without risk, if sufficient
 high-fidelity simulation software exists.
 This also makes it possible to use the Marine HIL-Lab for hybrid experimental
 test setups, where part of the experimental setup is real and part is simulated
, and these parts are interconnected through real-time interfaces such as
 sensors, communications, and actuators.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
http://www.marinecybernetics.com/solutions-services/drill-hil-testing
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Part
\begin_inset CommandInset label
LatexCommand label
name "part: Laboratory equipment"

\end_inset

Laboratory descriptions
\end_layout

\begin_layout Chapter
\begin_inset CommandInset label
LatexCommand label
name "sec: Marine HIL simulation laboratory"

\end_inset

Marine HIL simulation laboratory
\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename setupHIL.jpg
	width 95text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: HIL setup"

\end_inset

HIL setup
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
The laboratory is suitable for implementation, qualification and comprehensive
 testing of
\end_layout

\begin_layout Itemize
marine control algorithms
\end_layout

\begin_layout Itemize
communication interfaces,
\end_layout

\begin_layout Itemize
human-machine interfaces,
\end_layout

\begin_layout Itemize
experimental test scenarios, and
\end_layout

\begin_layout Itemize
experimental setups before proceeding to other laboratories (such as model
 scale testing).
\end_layout

\begin_layout Section
Equipment
\end_layout

\begin_layout Plain Layout
The laboratory consists of three equivalent portable setups, as illustrated
 in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: HIL setup"

\end_inset

, each including 
\end_layout

\begin_layout Itemize
Sony Sixaxis wireless gamepad for PlayStation 3,
\end_layout

\begin_layout Itemize
Raspberry Pi (RPi) with Bluetooth dongle,
\end_layout

\begin_layout Itemize
National Instruments (NI) cRIO-9024 control and acquisition device, and
\end_layout

\begin_layout Itemize
Dell Latitude E6440 laptop.
\end_layout

\begin_layout Subsection
Hardware
\end_layout

\begin_layout Subsubsection
Sixaxis wireless gamepad
\end_layout

\begin_layout Plain Layout
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
analog joysticks
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure-sensitive directional pad
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
analog triggers (L2, R2)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pressure-sensitive buttons (
\begin_inset Graphics
	filename sixaxis_triangle.png
	scale 40

\end_inset

, 
\begin_inset Graphics
	filename sixaxis_circle.png
	scale 40

\end_inset

, 
\begin_inset Graphics
	filename sixaxis_cross.png
	scale 40

\end_inset

, 
\begin_inset Graphics
	filename sixaxis_square.png
	scale 40

\end_inset

, L1, R1)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
digital buttons (PS, L3, R3, Start, Select)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
motion sensing (6 degrees of freedom)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: sixaxis input"

\end_inset

Sixaxis input
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
The Sixaxis is a widespread gamepad.
 It transmits a broad range of input, listed in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: sixaxis input"

\end_inset

, and is suitable for human operator input.
 The device communicates over Bluetooth.
\end_layout

\begin_layout Subsubsection
Raspberry Pi
\end_layout

\begin_layout Plain Layout
The RPi is a credit card-sized single-board computer including Ethernet
 and two USB connections.
 In the HIL laboratory setup, the unit is merely used to transmit the Sixaxis'
 data to the cRIO
\begin_inset Foot
status open

\begin_layout Plain Layout
The cRIO USB port only supports common USB mass-storage devices, thus a
 Bluetooth dongle cannot be connected directly.
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsubsection
cRIO-9024
\end_layout

\begin_layout Plain Layout
The cRIO is a compact reconfigurable input/output embedded real-time control
 and acquisition device, including two Ethernet ports.
 The unit also holds a field-programmable gate array (FPGA) chassis.
 In the HIL laboratory setup, an analog input module (NI 9215) and a digital
 output module (NI 9474) are mounted on this chassis.
\end_layout

\begin_layout Subsubsection
Laptop
\end_layout

\begin_layout Plain Layout
A generic personal computer is used to configure and upload applications
 to the cRIO.
 The same computer is used for graphical user interfacing during simulations.
\end_layout

\begin_layout Subsection
Software
\end_layout

\begin_layout Subsubsection
Laptop
\end_layout

\begin_layout Plain Layout
The main software used for the HIL laboratory are:
\end_layout

\begin_layout Description
MathWorks
\begin_inset space ~
\end_inset

Simulink graphical programming environment used for implementation and compilati
on of dynamic systems simulation models and control algorithms.
\end_layout

\begin_layout Description
National
\begin_inset space ~
\end_inset

Instruments
\begin_inset space ~
\end_inset

VeriStand real-time testing environment used to configure testing applications
 to run on cRIO and provides a user interface for run-time monitoring and
 interaction with the applications.
\end_layout

\begin_layout Description
Diverse
\begin_inset space ~
\end_inset

utilities such as
\end_layout

\begin_deeper
\begin_layout Description
National
\begin_inset space ~
\end_inset

Instruments
\begin_inset space ~
\end_inset

Measurement
\begin_inset space ~
\end_inset

&
\begin_inset space ~
\end_inset

Automation
\begin_inset space ~
\end_inset

Explorer (NI MAX) hardware configuration tool
\end_layout

\begin_layout Description
ping network utility to verify network connection
\end_layout

\begin_layout Description
ftp network utility, or similarly WinSCP, to transfer data log files from
 cRIO to the laptop
\end_layout

\end_deeper
\begin_layout Plain Layout
\begin_inset Note Note
status open

\begin_layout Description
National
\begin_inset space ~
\end_inset

Instruments
\begin_inset space ~
\end_inset

LabVIEW
\end_layout

\begin_layout Description

\series bold
LabVIEW - Real time module
\series default

\begin_inset Newline newline
\end_inset

 National Instruments real-time technology offers reliable, deterministic
 performance for your time-critical applications.
 Use the LabVIEW Real-Time Module to develop and deploy complex real-time
 systems quickly and efficiently to the CompactRIO microprocessor.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Laptop software"

\end_inset

 covers installation and setup of the laptop software.
\end_layout

\begin_layout Subsubsection
Sixaxis, Raspberry Pi and cRIO-9024
\end_layout

\begin_layout Plain Layout
The Sixaxis, RPi and cRIO are configured for generic use according to Part
 
\begin_inset CommandInset ref
LatexCommand ref
reference "part: Laboratory user guide"

\end_inset

 and the ordinary user may thus disregard the involved software.
\end_layout

\begin_layout Plain Layout
The Sixaxis runs out-of-the-box firmware.
 Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: cRIO setup"

\end_inset

 covers the cRIO software and setup details.
 Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: RPi setup"

\end_inset

 covers the RPi software and setup details.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub: HIL lab Communication"

\end_inset

Communication
\end_layout

\begin_layout Plain Layout
Following Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: HIL setup"

\end_inset

 from left to right:
\end_layout

\begin_layout Description
Sixaxis transmits its information to the Bluetooth USB dongle with which
 it is previously paired
\begin_inset Foot
status open

\begin_layout Plain Layout
One-time pairing procedure described in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "par: Bluetooth-pairing"

\end_inset

.
\end_layout

\end_inset

.
\end_layout

\begin_layout Description
RPi receives Sixaxis data through the USB dongle and forwards it through
 its TCP/IP
\begin_inset Foot
status open

\begin_layout Plain Layout
All IP addresses are as given in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: IP addresses"

\end_inset

.
\end_layout

\end_inset

 server over Ethernet to the cRIO.
\end_layout

\begin_layout Description
cRIO reads Sixaxis data on Ethernet port 2 through its TCP/IP client.
 Simulation data and laptop input is transmitted and received on Ethernet
 port 1 by the VeriStand Engine.
\end_layout

\begin_layout Description
Laptop reads simulation data and sends input to the cRIO over Ethernet.
\end_layout

\begin_layout Plain Layout
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Simulation models
\end_layout

\begin_layout Subsection
Cybership Enterprise 1
\end_layout

\begin_layout Plain Layout
eta
\end_layout

\begin_layout Subsubsection
Forces and moment input
\end_layout

\begin_layout Plain Layout
CSE1_HIL_tau.out
\end_layout

\begin_layout Plain Layout
Input:
\end_layout

\begin_layout Subsubsection
Control input
\end_layout

\begin_layout Plain Layout
CSE1_HIL_u.out
\end_layout

\begin_layout Plain Layout
\begin_inset Newpage clearpage
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Part
\begin_inset CommandInset label
LatexCommand label
name "part: Laboratory user guide"

\end_inset

Laboratory user guide
\end_layout

\begin_layout Chapter
Safety
\end_layout

\begin_layout Section
Hazards and measures
\end_layout

\begin_layout Subsection
Personnel injury
\end_layout

\begin_layout Paragraph
Drowning
\end_layout

\begin_layout Standard
It is required to have two or more persons present when using the basin.
\end_layout

\begin_layout Paragraph
Electric shock
\end_layout

\begin_layout Standard
The towing catenary should not be approached or touched.
\end_layout

\begin_layout Paragraph
Carriage collision
\end_layout

\begin_layout Standard
It is forbidden to run the towing carriage when there are people alongside
 the basin.
\end_layout

\begin_layout Paragraph
Thruster blade cuts
\end_layout

\begin_layout Standard
Vessels must stay in the water as long as actuators are active.
 Before removing the vessels from the water, the control system must be
 stopped and disabled, for instance by undeploying in the VeriStand project.
\end_layout

\begin_layout Subsection
Material damage
\end_layout

\begin_layout Paragraph
Cybership Enterprise 1
\end_layout

\begin_layout Description
Water
\begin_inset space ~
\end_inset

damage: CSE1 is not waterproof and has excessive thrust capability which
 can inflict large roll angles.
 The risk of water on deck is reduced through thrust limitation and HIL
 testing before application of new control algorithms.
 
\end_layout

\begin_layout Description
Propeller
\begin_inset space ~
\end_inset

dry
\begin_inset space ~
\end_inset

running: BT must only be run in water.
 Before removing the vessel from the water, the control system must be stopped
 and the VeriStand project undeployed.
\end_layout

\begin_layout Description
Loss
\begin_inset space ~
\end_inset

of
\begin_inset space ~
\end_inset

laptop
\begin_inset space ~
\end_inset

control: Wireless network instability may result in loss of connection between
 the laptop user interface and the cRIO.
 In this event, fall back to manual thruster control, by pushing 
\begin_inset Graphics
	filename sixaxis_triangle.png
	scale 40

\end_inset

 on the Sixaxis.
\end_layout

\begin_layout Description
Loss
\begin_inset space ~
\end_inset

of
\begin_inset space ~
\end_inset

position
\begin_inset space ~
\end_inset

measurement: -
\end_layout

\begin_layout Description
Total
\begin_inset space ~
\end_inset

loss
\begin_inset space ~
\end_inset

of
\begin_inset space ~
\end_inset

control: Pull the vessel with a boat hook.
 Keep the CSE1 in water while disconnecting batteries.
\end_layout

\begin_layout Paragraph
Towing carriage
\end_layout

\begin_layout Standard
Stop before automatic stop at high speeds.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
Qualisys motion capture system
\end_layout

\begin_layout Section
Start Qualisys Track Manager
\end_layout

\begin_layout Enumerate
Execute the program.
 The first displayed window is as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Qualisys Track Manager start window"

\end_inset

.
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename qualisys_new.PNG
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Qualisys Track Manager start window"

\end_inset

Qualisys Track Manager start window
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Push the white sheet icon to start a new measurement.
 The main window should then display the 2D view, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Qualisys Track Manager 2D view"

\end_inset

.
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename qualisys_3cams.PNG
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Qualisys Track Manager 2D view"

\end_inset

Qualisys Track Manager 2D view
\end_layout

\end_inset


\end_layout

\end_inset

 The squares numbered #1, #2 and #3 are show the basin as seen from the
 respective cameras.
 The white dots are the vessel reflectors.
 A minimum of three reflectors must be visible in each camera.
 
\end_layout

\begin_layout Section
Aquire body
\end_layout

\begin_layout Enumerate
Push the gear icon to access Project Options.
 Navigate to 6DOF Tracking, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Qualisys-Track-Manager6DOF"

\end_inset

.
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename qualisys_6dof.PNG
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Qualisys-Track-Manager6DOF"

\end_inset

Qualisys Track Manager 6 DOF Tracking
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Remove previous bodies, if any.
\end_layout

\begin_layout Enumerate
Align the vessel with desired heading 0 and push 
\begin_inset Quotes eld
\end_inset

Acquire Body
\begin_inset Quotes erd
\end_inset

 to get the position of the reflectors.
 A list appears, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Qualisys-Track-ManagerAquiredBody"

\end_inset

.
 
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename qualisys_orientating.PNG
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Qualisys-Track-ManagerAquiredBody"

\end_inset

Qualisys Track Manager aquired body
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
To redefine the body fixed coordinate frame 
\end_layout

\begin_deeper
\begin_layout Enumerate
Chose a reference reflector.
 As highlighted in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Qualisys-Track-ManagerAquiredBody"

\end_inset

, it may be practical to choose the highest-most, in this case reflector
 3.
\end_layout

\begin_layout Enumerate
Push 
\begin_inset Quotes eld
\end_inset

Translate
\begin_inset Quotes erd
\end_inset

 and enter the coordinates of the chosen reflector in the desired frame.
 In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Qualisys-Track-Managertranslate"

\end_inset

, reflector 3 is set at 
\begin_inset Formula $x,y,z=\left(0.550,0,-0.500\right)$
\end_inset

.
 
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename qualisys_orientating2.PNG
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Qualisys-Track-Managertranslate"

\end_inset

Qualisys Track Manager translate body
\end_layout

\end_inset


\end_layout

\end_inset

 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Qualisys-Track-Managertranslated"

\end_inset

 shows the resulting coordinates after translation.
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename qualisys_orientating3.PNG
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Qualisys-Track-Managertranslated"

\end_inset

Qualisys Track Manager translated body
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Finally, select 3D view to confirm that the body-fixed frame is indeed located
 as desired, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Qualisys-Track-Managerr3D"

\end_inset

.
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename qualisys_3d.PNG
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Qualisys-Track-Managerr3D"

\end_inset

Qualisys Track Manager 3D view
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Start server
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename qualisys_waiting_to_connect.JPG
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Matlab console
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: matlab console-1"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Section
Aquire body
\end_layout

\begin_layout Standard
leverer med 50Hz på nettet
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
Towing carriage
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename towing_carriage.jpg
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Towing carriage"

\end_inset

Towing carriage
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The scope of this section is to explain how to safely operate the carriage
 without any damage towards humans or equipment.
 
\end_layout

\begin_layout Section
Preparation before startup
\end_layout

\begin_layout Standard
To start with, you must make sure that any items mounted or fixed to the
 carriage are securely fitted, so they don't prevent the operation of the
 carriage.
 All personnel must stay on the operation platform during the travel of
 any axis.
\end_layout

\begin_layout Standard
Locate the Emergency Button and place it so that you can easily reach it
 from where you are sited.
 DO NOT USE THE EMERGENCY BUTTOM AS A BRAKE.
 YOU MUST ONLY OPERATE IT WHEN YOU ARE IN REAL EMERGENCY SITUATIONS.
\end_layout

\begin_layout Subsection
Operation console
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename towing_console.jpg
	width 80text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Towing console"

\end_inset

Towing console
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The operation console is an All-in-one PC.
 The Power button is on the bottom right side of the screen.
 If the operation panel is not on the desktop, you can start it by double
 clicking on desktop Icon, shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Towing console"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Manual Operation of the Carriage
\end_layout

\begin_layout Subsection
Setup
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename towing_coordinate_sketch.jpg
	width 80text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Towing carriage-1"

\end_inset

Coordinate system
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename towing_coordinate_photo.jpg
	width 80text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Coordinate system
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="7">
<features rotate="0" tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<column alignment="left" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Forward/Backward
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Acceleration
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Position
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Axis
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Speed
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Deceleration
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Pos./Neg.
 Limit
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
X
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 2.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m/s] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
% of 0 - 0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{m/s^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 22
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Y
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m/s] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
% of 0 - 1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{m/\ensuremath{s^{2}}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 4.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
U
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m/s] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
% of 0 - 1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{m/s^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 10 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[deg/s]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
% of 0 - 20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{deg/s^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 255
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[deg]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Z
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m/s] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
% of 0 - 2.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{m/s^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
W
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 1.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m/s] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
% of 0 - 2.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{m/s^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0 - 0.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
[m]
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: Operation Limit"

\end_inset

Operation Limit
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename towing_parameteres.jpg
	width 80text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Towing parameters"

\end_inset

Setup
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It is very important to select the Setup tab first before you start any
 operation of the carriage.
 As you can see in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Towing parameters"

\end_inset

, it is possible to change the travel parameters for all available axes.
 In principle, all axis parameters have different range limits.
 These are listed in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: Operation Limit"

\end_inset

.
\end_layout

\begin_layout Standard
All axes can be activated or deactivate by using the ON button.
\end_layout

\begin_layout Standard
For the X axis it is possible to activate a list of predefined Forward speeds.
 You will then have the ability to automatically change to a different speed
 on the next run.
 The list can be edited in the Main Tab Window.
\end_layout

\begin_layout Standard
By selecting the 
\begin_inset Quotes eld
\end_inset

Lock Z-W
\begin_inset Quotes erd
\end_inset

 button the Z-W axis will operate in parallel.
 They will use the Z-axis parameter setup.
\end_layout

\begin_layout Subsection
Main/Standard Operation
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename towing_main.jpg
	width 80text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Towing main"

\end_inset

Main
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
All the activated axes will operate within the limits set in the Setup.
 Only one axis can operate at a time.
 If you hit the button for another axis than the running one, it will instantly
 stop and new one will start running.
 To stop the running axis, simply hit the stop button.
 If no buttons are operated carriage axis will run it hit limit position
 of the current axis.
\end_layout

\begin_layout Standard
If an error occurs, for some reason, it can be cleared by hitting the 
\begin_inset Quotes eld
\end_inset

Power
\begin_inset Quotes erd
\end_inset

 button.
 If the error keeps reoccurring, please look at the Troubleshooting section
 of this document or contact responsible MC Lab personnel.
\end_layout

\begin_layout Standard
The current speed and position of the active axis are displayed referred
 to the selected limits.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Operation Controlled automatically from PC
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename towing_runfromfile.jpg
	width 80text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Towing main-1"

\end_inset

Run From File
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
The Trajectory Input File
\end_layout

\begin_layout Standard
All trajectories must be defined in a .mcl input file.
 The format of the file is slightly more general than allowed here and is
 the same as for the sloshing rig input.
 The entries in the file are
\end_layout

\begin_layout Enumerate
Time Step in ms, double precision integer (int32).
 Must be set to 10.
\end_layout

\begin_layout Enumerate
Number of channels, double precision integer (int32).
 Must be 6.
\end_layout

\begin_layout Enumerate
Position references in sequence: X(1),Y(1),U(1),C(1),Z(1),W(1), X(2),Y(2),…
 double precision real (float32).
\end_layout

\begin_layout Standard
The following MTALAB lines write the matrix body (6xN) to file on the correct
 format:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}
\end_layout

\begin_layout Plain Layout

fid=fopen(filename,'wb');
\end_layout

\begin_layout Plain Layout

head=[10;6];
\end_layout

\begin_layout Plain Layout

count=fwrite(fid,head,'int32');
\end_layout

\begin_layout Plain Layout

count=count+fwrite(fid,body,'float32');
\end_layout

\begin_layout Plain Layout

fclose(fid); 
\end_layout

\begin_layout Plain Layout


\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The resulting input file must be transferred to the realtime computer at
 /home/ntuser/inputpos.mcl.
 Normally this is done automatically when the Load button on the LabVIEW
 GUI is pressed.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename towing_ampvsfreq.jpg
	width 80text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Towing main-1-1"

\end_inset

Operation Limit Amplitude vs.
 Frequency
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Troubleshooting
\end_layout

\begin_layout Standard
-
\end_layout

\begin_layout Section
Note
\end_layout

\begin_layout Standard
When the wagon is moving, no one is allowed to move on the sides of the
 basin.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Basic parameter identification
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
todo{
\end_layout

\end_inset

Jon master
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
Wave generator
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
todo{
\end_layout

\end_inset

Get basic information from Astrid, including hacking of wave series
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
Current generator
\end_layout

\begin_layout Standard
-
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
CS Inocean Cat I Arctic Drillship
\end_layout

\begin_layout Section
Mathematical model
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
todo{
\end_layout

\end_inset

Add material from Jon
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
CS Enterprise I
\end_layout

\begin_layout Section
Mathematical model
\end_layout

\begin_layout Standard
The proposed control design model is
\begin_inset Formula 
\begin{eqnarray}
\dot{\eta} & = & R\left(\psi\right)\nu\label{eq: CSE1 kinematics}\\
M\dot{\nu} & = & -C\left(\nu\right)\nu-D\left(\nu\right)\nu+\tau\label{eq: CSE1 kinetics}
\end{eqnarray}

\end_inset

where
\end_layout

\begin_layout Itemize
the pose and velocity vectors are
\begin_inset Formula 
\[
\eta=\left[\begin{array}{c}
x\\
y\\
\psi
\end{array}\right]\in\mathbb{R}^{3}\text{, and }\nu=\left[\begin{array}{c}
u\\
v\\
r
\end{array}\right]\in\mathbb{R}^{3},
\]

\end_inset

respectively.
 
\begin_inset Formula $\left(x,y\right)$
\end_inset

 is the position and 
\begin_inset Formula $\psi$
\end_inset

 the yaw angle or heading in the basin frame.
 
\begin_inset Formula $\left(u,v\right)$
\end_inset

 are the surge and sway velocities in the CSE1 vessel frame, and 
\begin_inset Formula $r$
\end_inset

 is the yaw rate.
\end_layout

\begin_layout Itemize
the thrust force and moment vector is
\begin_inset Formula 
\[
\tau=\left[\begin{array}{c}
X\\
Y\\
N
\end{array}\right]\in\mathbb{R}^{3},
\]

\end_inset

where 
\begin_inset Formula $\left(X,Y\right)$
\end_inset

 is the surge and sway force vector, and 
\begin_inset Formula $N$
\end_inset

 is the yaw moment.
\end_layout

\begin_layout Itemize
the three degrees of freedom (3 DOF) rotation matrix is
\begin_inset Formula 
\[
R\left(\psi\right)=\left[\begin{array}{ccc}
\cos\psi & -\sin\psi & 0\\
\sin\psi & \cos\psi & 0\\
0 & 0 & 1
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Itemize
the vessel inertia matrix is
\begin_inset Formula 
\[
M=\left[\begin{array}{ccc}
m-X_{\dot{u}} & 0 & 0\\
0 & m-Y_{\dot{v}} & mx_{g}-Y_{\dot{r}}\\
0 & mx_{g}-Y_{\dot{r}} & I_{z}-N_{\dot{r}}
\end{array}\right]=M^{\top}>0.
\]

\end_inset

 
\end_layout

\begin_layout Itemize
the coriolis and centripetal matrix is
\begin_inset Formula 
\[
C\left(\nu\right)=\left[\begin{array}{ccc}
0 & -mr & Y_{\dot{v}}v+\left(Y_{\dot{r}}-mx_{g}\right)r\\
mr & 0 & -X_{\dot{u}}u\\
-Y_{\dot{v}}v-\left(Y_{\dot{r}}-mx_{g}\right)r & X_{\dot{u}}u & 0
\end{array}\right]=-C^{\top}\left(\nu\right).
\]

\end_inset


\end_layout

\begin_layout Itemize
the damping matrix is
\begin_inset Formula 
\[
D\left(\nu\right)=\left[\begin{array}{ccc}
d_{11}\left(u\right) & 0 & 0\\
0 & d_{22}\left(v,r\right) & d_{23}\left(v,r\right)\\
0 & d_{32}\left(v,r\right) & d_{33}\left(v,r\right)
\end{array}\right],
\]

\end_inset

where the damping components are 
\begin_inset Formula 
\begin{eqnarray}
d_{11}\left(u\right) & = & -X_{u}-X_{\left\vert u\right\vert u}\left\vert u\right\vert -X_{uuu}u^{2}\label{Eq:d11}\\
d_{22}\left(v,r\right) & = & -Y_{v}-Y_{\left\vert v\right\vert v}\left\vert v\right\vert -Y_{vvv}v^{2}-Y_{\left\vert r\right\vert v}\left\vert r\right\vert \label{Eq:d22}\\
d_{23}\left(v,r\right) & = & -Y_{r}-Y_{\left\vert v\right\vert r}\left\vert v\right\vert -Y_{\left\vert r\right\vert r}\left\vert r\right\vert -Y_{rrr}r^{2}\label{Eq:d23}\\
d_{32}\left(v,r\right) & = & -N_{v}-N_{\left\vert v\right\vert v}\left\vert v\right\vert -N_{vvv}v^{2}-N_{\left\vert r\right\vert v}\left\vert r\right\vert \label{Eq:d32}\\
d_{33}\left(v,r\right) & = & -N_{r}-N_{\left\vert v\right\vert r}\left\vert v\right\vert -N_{\left\vert r\right\vert r}\left\vert r\right\vert -N_{rrr}r^{2}\label{Eq:d33}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
On component form, the three kinetic equations from 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq: CSE1 kinetics"

\end_inset

 are
\begin_inset Formula 
\begin{eqnarray}
X & = & \left(m-X_{\dot{u}}\right)\dot{u}-\left(m-Y_{\dot{v}}\right)vr+\left(Y_{\dot{r}}-mx_{g}\right)r^{2}+d_{11}\left(u\right)u\label{Eq:Tu}\\
Y & = & \left(m-Y_{\dot{v}}\right)\dot{v}+\left(mx_{g}-Y_{\dot{r}}\right)\dot{r}+\left(m-X_{\dot{u}}\right)ur\\
 &  & +d_{22}\left(v,r\right)v+d_{23}\left(v,r\right)r\label{Eq:Tv}\\
N & = & \left(mx_{g}-Y_{\dot{r}}\right)\dot{v}+\left(I_{z}-N_{\dot{r}}\right)\dot{r}+\left(X_{\dot{u}}-Y_{\dot{v}}\right)uv-\left(Y_{\dot{r}}-mx_{g}\right)ur\\
 &  & +d_{32}\left(v,r\right)v+d_{33}\left(v,r\right)r\label{Eq:Tr}
\end{eqnarray}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="4">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Rigid body
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Added mass
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Value
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameter
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Value
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $14.79$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{\dot{u}}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-2$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $I_{z}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.76$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{\dot{v}}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-10$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x_{g}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.0375$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{\dot{r}}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y_{g}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.0$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{\dot{r}}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: CSE1-rigid-body"

\end_inset

CSE1 rigid body and added mass parameters
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The rigid body inertia and hydrodynamic added mass parameters are given
 in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: CSE1-rigid-body"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="6">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Hydro surge
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Hydro sway
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Hydro yaw
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Parameter
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Value
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Parameter
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Value
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Parameter
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Value
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{u}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.4543$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{v}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-3.083$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{v}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4.1117\cdot10^{-4}$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{r}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-7.25$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{r}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1.9$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: CSE1 damping parameters 1"

\end_inset

CSE1 damping parameters
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="6">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<row>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Hydro surge
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Hydro sway
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Hydro yaw
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Parameter
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Value
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Parameter
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Value
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Parameter
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Value
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{u}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.6555$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{v}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1.33$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{v}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.0$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{uu}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.3545$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{vv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-2.776$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{vv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.2088$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{uuu}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-3.787$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{vvv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-64.91$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{vvv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.0$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{v}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.0$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{r}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-7.25$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{r}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1.9$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{vv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-2.443$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{rr}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-3.45$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{rr}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.75$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{vvv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.0$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{rrr}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.0$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{rrr}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.0$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $.$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $.$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{rv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.805$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{rv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.130$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $.$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $.$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{vr}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.845$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N_{vr}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.080$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: CSE1 damping parameters 2"

\end_inset

CSE1 damping parameters
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The hydrodynamic damping parameters are given in Tables 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: CSE1 damping parameters 1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: CSE1 damping parameters 2"

\end_inset

.
\end_layout

\begin_layout Standard
The model is valid for low-speed.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Model-in-the-loop simulation
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Processor-in-the-Loop simulation
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename CSE1_ctrl_student.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CSE1 ctrl_student.slx"

\end_inset

CSE1 
\family typewriter
ctrl_student.slx
\family default
 including thrust allocation
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Implementation of the student controller is done in the 
\family typewriter
ctrl_student.slx
\family default
 Simulink template, depicted in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: CSE1 ctrl_student.slx"

\end_inset

.
 Detailed implementation steps are given in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec: CSE1 Student controller implementation"

\end_inset

.
\end_layout

\begin_layout Standard
The generic control system consists of several Simulink modules, the details
 of which are given in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: CSE1 Control software"

\end_inset

, a FPGA driver, described in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Create-FPGA-target"

\end_inset

, and two custom device drivers.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Basin testing
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sec: CSE1 Student controller implementation"

\end_inset

Student controller implementation
\end_layout

\begin_layout Enumerate
Unzip the CSE1 Veristand Project 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset


\family typewriter
CSE1.zip
\family default

\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 to 
\family typewriter
C:
\backslash
CSE1
\backslash

\family default
.
\begin_inset Foot
status open

\begin_layout Plain Layout
Other paths are possible but require changing all VeriStand project paths.
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Simulink implementation and compilation
\end_layout

\begin_deeper
\begin_layout Enumerate
Update 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset


\family typewriter
ctrl_student.slx
\family default

\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 according to your controller design.
 Additional input and output, resets and data logging may be added, as described
 in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Simulink modeling"

\end_inset

.
\begin_inset Newline newline
\end_inset

Do not alter the predefined input and output: x, y, psi, u_BT, u_VSP1, u_VSP2,
 alpha_VSP1, alpha_VSP2, omega_VSP1 and omega_VSP2.
\end_layout

\begin_layout Enumerate
Select a suitable solver, as described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Simulink model configuration"

\end_inset

.
\begin_inset Newline newline
\end_inset

The remaining configuration, such as target selection is preselected in
 the file.
\end_layout

\begin_layout Enumerate
Compile the model as described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Simulink model build"

\end_inset

.
 The MATLAB current folder should be 
\family typewriter
C:
\backslash
CSE1
\backslash

\family default
, in order to ensure that the resulting 
\family typewriter
.out
\family default
 file is created in 
\family typewriter
C:
\backslash
CSE1
\backslash
ctrl_student_niVeriStand_VxWorks_rtw
\family default
.
\end_layout

\end_deeper
\begin_layout Enumerate
CSE1 Veristand Project configuration
\end_layout

\begin_deeper
\begin_layout Enumerate
Open 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset


\family typewriter
CSE1.nivsproj
\family default

\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Not 
\family typewriter
CSE1.nivssdf
\family default
, since not only the system definition should be altered.
\end_layout

\end_inset

 to access the project.
\end_layout

\begin_layout Enumerate
Update 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset


\family typewriter
ctrl_student.out
\family default

\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

:
\end_layout

\begin_deeper
\begin_layout Enumerate
Open the System Explorer by double-clicking the system definition file 
\family typewriter
CSE1.nivssdf
\family default
.
\end_layout

\begin_layout Enumerate
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename CSE1_update_ctrl_studtent.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CSE1 simulation models"

\end_inset

CSE1 Veristand Project simulation models
\end_layout

\end_inset


\end_layout

\end_inset

Browse the left pane tree, as seen in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: CSE1 simulation models"

\end_inset

, and select ctrl_student.
 Refresh by pushing the 
\begin_inset Graphics
	filename veristand_refresh.jpg
	scale 80

\end_inset

 icon.
\end_layout

\begin_layout Enumerate
If necessary, add mappings.
\begin_inset Newline newline
\end_inset

Do not change the existing mappings.
 Position input (x, y, psi) and controller output (u_BT, u_VSP1, u_VSP2,
 alpha_VSP1, alpha_VSP2, omega_VSP1, omega_VSP2) are already mapped as necessary.
\end_layout

\begin_layout Enumerate
Save and close to return to the Project Explorer.
\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename CSE1_student_workspace.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CSE1 student_ctrl workspace"

\end_inset

CSE1 Veristand Project ctrl_student workspace
\end_layout

\end_inset


\end_layout

\end_inset

Implement a suitable workspace, as described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Create computer interface"

\end_inset

, for your controller in control screen 4: ctrl_student.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: CSE1 student_ctrl workspace"

\end_inset

 shows control screen 4 before customization.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Ship launching procedure - before sailing
\end_layout

\begin_layout Subsubsection
Power up and connection
\end_layout

\begin_layout Enumerate
\noindent
Place the batteries adjacent to the watertight box: main battery battery
 (12 V) astern and secondary battery (6 V) in the bow.
\end_layout

\begin_layout Enumerate
\noindent
Connect main battery: first the red wire to the red/positive pole, then
 the black wire to the black/negative pole
\begin_inset Foot
status open

\begin_layout Plain Layout
The connection order of the wires should not matter.
 However, experiences favor the this order of connection.
\end_layout

\end_inset

.
\begin_inset Newline newline
\end_inset

cRIO LED nr.1 (power) will light up green.
\begin_inset Note Note
status open

\begin_layout Plain Layout
\noindent
Red blinking LEDs on each VSP motor controller.
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Wait for cRIO and RPi start up.
\begin_inset Newline newline
\end_inset

When complete, the Bluetooth dongle blue LED blinks evenly at approximately
 1 Hz.
\begin_inset Note Note
status open

\begin_layout Plain Layout
The 
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Turn on Sixaxis by pushing the PS3 button.
\begin_inset Newline newline
\end_inset

When succesfully connected, the Bluetooth dongle blue LED is almost constantly
 lit and the Sixaxis' red LEDs 1, 2, 3, and 4 blink at approximately 2 Hz.
\end_layout

\begin_layout Enumerate
Connect the seconday battery: red wire to the red/positive pole, then the
 black wire to the black/negative pole.
\begin_inset Newline newline
\end_inset

The Wifi bridge Power LED will light up green.
\begin_inset Note Note
status open

\begin_layout Plain Layout
Red LED on purple motor control
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Wait for WiFi connection to HILlab network.
\begin_inset Newline newline
\end_inset

When connected, the Wifi bridge WLAN green LED turns on.
\end_layout

\begin_layout Enumerate
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename cRIO_ping.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: ping"

\end_inset

Ping, successful access to CSE1
\end_layout

\end_inset


\end_layout

\end_inset

Verify laptop access: ping the CSE1 IP in the command promt, as in Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: ping"

\end_inset

.
 While the round trip times may vary, it is essential to have 0% loss.
\end_layout

\begin_layout Enumerate
Gently place the vessel in the basin, avoiding any water splashes.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Paragraph
Troubleshooting
\end_layout

\begin_layout Enumerate
Check Laptop is connected to wireless network “HILlab”, if not connect to
 it “HILlab”
\end_layout

\begin_layout Enumerate
Check ACT/LiNK” port 1 are showing activity e.g.
 are lit, blinking, if not check ethernet cable is connected to “ACT/LiNK”
 port 1 and to the “D-Link Wireless Bridge” if not connect to those Battery
 gives power to “CompactRIO” and “D-Link”, lights/indicators are lit/blinking
 if not check wiring
\end_layout

\begin_layout Enumerate
Check battery voltages, “Main battery” should be 10 Volt or more, maximum
 around 13 Volt, regular 11 to 12 Volt, low 10 Volt “Servo battery” should
 be in 5 Volt or more, max around 6.4 Volt, regular around 6 Volt
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Positioning system
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Deploy control system
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
todo{
\end_layout

\end_inset

Veristand osv
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
A diagram representation of CSE1's control system is given in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: CSE1 generic control system"

\end_inset

.
 The first three controllers are predefined, while users may implement their
 own controller in the fourth.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top" width="6.5cm">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Sixaxis
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Control mode
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename sixaxis_triangle.png
	scale 40

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Manual thruster control
\end_layout

\begin_layout Plain Layout
VSP speed: directional pad up/down 
\begin_inset Formula $\pm0.1$
\end_inset


\end_layout

\begin_layout Plain Layout
Left joystick: VSP1 thrust
\end_layout

\begin_layout Plain Layout
Right joystick: VSP2 thrust
\end_layout

\begin_layout Plain Layout
L2/R2: BT thrust
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename sixaxis_square.png
	scale 40

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Manual forces and moment control
\end_layout

\begin_layout Plain Layout
VSP speed: user interface button on/off
\end_layout

\begin_layout Plain Layout
Left joystick: surge and sway forces
\end_layout

\begin_layout Plain Layout
L2/R2: yaw moment
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename sixaxis_circle.png
	scale 40

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Basic dynamic positioning (DP)
\end_layout

\begin_layout Plain Layout
VSP speed: user interface button on/off
\end_layout

\begin_layout Plain Layout
Setpoint: user interface
\end_layout

\begin_layout Plain Layout
Gains: user interface
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename sixaxis_cross.png
	scale 40

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Student controller
\end_layout

\begin_layout Plain Layout
User implemented controller
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: CSE1 control system modes"

\end_inset

Generic control modes
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The vessel can switch among four control modes, summarized in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: CSE1 control system modes"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Ship docking procedure - after sailing
\end_layout

\begin_layout Standard
Undeploy the running project to disable all actuators.
\end_layout

\begin_layout Standard
Lift out of water avoiding water on rail.
\end_layout

\begin_layout Standard
Put CSE1 in its stand.
 The vessel should not be left on the water for extensive periods, i.e.
 overnight.
\end_layout

\begin_layout Standard
Remove and put used batteries to charge.
 Load fresh batteries in vessel.
\end_layout

\begin_layout Standard
Connect the Sixaxis gamepad to the laptop for charging.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Troubleshooting
\end_layout

\begin_layout Standard
-
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
typiske feil
\end_layout

\begin_layout Plain Layout
batteri
\end_layout

\begin_layout Plain Layout
nettverk
\end_layout

\begin_layout Plain Layout
Sixaxis will sometimes only charge through PC USB-port.
 Not RPi nor USB charger.
\end_layout

\begin_layout Chapter
Checklist
\end_layout

\begin_layout Plain Layout
Device driver in place
\end_layout

\begin_layout Plain Layout
Custom indicators in place
\end_layout

\begin_layout Plain Layout
PC and cRIO IP correct
\end_layout

\begin_layout Plain Layout
Sixaxis charged
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
CS Saucer
\end_layout

\begin_layout Section
Required Software
\end_layout

\begin_layout Standard
NI LabVIEW software required to run the project 
\begin_inset Quotes eld
\end_inset

CyberShip Saucer
\begin_inset Quotes erd
\end_inset

:
\end_layout

\begin_layout Enumerate
LabVIEW 2014
\end_layout

\begin_layout Enumerate
LabVIEW 2014 myRIO Toolkit
\end_layout

\begin_layout Enumerate
LabVIEW 2014 Real-Time Module
\end_layout

\begin_layout Enumerate
LabVIEW Control Design and Simulation Module
\end_layout

\begin_layout Section
Deployment
\end_layout

\begin_layout Standard
When the power source is connected and the Wi indicator lights up, the vessel
 is ready to deploy.
\end_layout

\begin_layout Itemize
Run the host application 
\begin_inset Quotes eld
\end_inset

mainHost.vi
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Itemize
Deploy the target application 
\begin_inset Quotes eld
\end_inset

main.vi
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
The vessel is now operational.
\end_layout

\begin_layout Section
NI Dashboard Manual Control
\end_layout

\begin_layout Standard
The CS Saucer can be controlled directly from an Android or a iOS device
 with the NI Dashboard app.
\end_layout

\begin_layout Section
Manual Thruster Control
\end_layout

\begin_layout Itemize
Make sure that your device is connected to the local are network with a
 static ip adress.
\end_layout

\begin_layout Itemize
Create a new Dashboard with six slide controls, these will be the six control
 inputs 
\begin_inset Formula $u_{0}$
\end_inset

, 
\begin_inset Formula $u_{1}$
\end_inset

, 
\begin_inset Formula $u_{2}$
\end_inset

, 
\begin_inset Formula $\alpha_{0}$
\end_inset

, 
\begin_inset Formula $\alpha_{1}$
\end_inset

 and 
\begin_inset Formula $\alpha_{2}$
\end_inset

.
\end_layout

\begin_layout Itemize
Congure the scale of the slide controls so that 
\begin_inset Formula $u\in\left[-1,1\right]$
\end_inset

 and 
\begin_inset Formula $\alpha\in\left[-114,114\right]$
\end_inset


\end_layout

\begin_layout Itemize
Tap a control to connect it to its corresponding shared variable node on
 the myRIO.
 The ip adress for the myRIO-Saucer is: 192:168:0:99.
\end_layout

\begin_layout Itemize
The shared variable nodes for the manual thruster control are located in
 the library 
\begin_inset Quotes eld
\end_inset

libctrlMaualThruster
\begin_inset Quotes erd
\end_inset

.
 Be careful to only use the variables with the label 
\begin_inset Quotes eld
\end_inset

DSH
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Itemize
Start the dashboard.
\end_layout

\begin_layout Section
Manual Force Control
\end_layout

\begin_layout Itemize
Make sure that your device is connected to the local are network with a
 static ip adress.
\end_layout

\begin_layout Itemize
Create a new Dashboard with three slide controls, this will be the commanded
 force vector 
\begin_inset Formula $\tau=\left[X,Y,N\right]^{\top}$
\end_inset

.
\end_layout

\begin_layout Itemize
Congure the scale of the slide controls so that 
\begin_inset Formula $X=\left[-9;9\right]$
\end_inset

, 
\begin_inset Formula $Y=\left[-9;9\right]$
\end_inset

 and 
\begin_inset Formula $N=\left[-4;4\right]$
\end_inset


\end_layout

\begin_layout Itemize
Tap a control to connect it to its corresponding shared variable node on
 the myRIO.
 The ip adress for the myRIO-Saucer is: 192:168:0:99.
\end_layout

\begin_layout Itemize
The shared variable nodes for the manual force control are located in the
 library 
\begin_inset Quotes eld
\end_inset

libctrlMaualForce
\begin_inset Quotes erd
\end_inset

.
 Be careful to only use the variables with the label 
\begin_inset Quotes eld
\end_inset

DSH
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Itemize
Start the dashboard.
\end_layout

\begin_layout Section
Data logging
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Saucer_mapnetworkdrive.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Saucer map network"

\end_inset

Map network drive to the NI myRIO.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Saucer_credentials.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Saucer credentials"

\end_inset

Login credentials on the myRIO-Saucer.
 The password is blank.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename saucer_logfiles.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Saucer log files"

\end_inset

The log les are saved in the tmp folder on the myRIO
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Continuous data logging has been implemented in the main target application.
 On initialization, a 
\begin_inset Quotes eld
\end_inset

.csv
\begin_inset Quotes erd
\end_inset

 le is created for each of the control modes.
 The log le for a control mode will only be populated when that particular
 control mode is active.
 Each log le is created with a control mode identier and a time stamp, e.g.
 
\begin_inset Quotes eld
\end_inset

dp114700
\begin_inset Quotes erd
\end_inset

.
 The log le format 
\begin_inset Quotes eld
\end_inset

.csv
\begin_inset Quotes erd
\end_inset

 (comma separated values) is highly compatible with MATLAB and enables easy
 import and post processing of the data in MATLAB.
 The import code in the script is easily created using MATLAB's import le
 wizard which generates code for le import for a specic le.
\end_layout

\begin_layout Standard
The log les on the myRIO are stored in the 
\begin_inset Quotes eld
\end_inset

les/tmp
\begin_inset Quotes erd
\end_inset

 folder which is a temporary folder that is cleared on reboot.
 Saving the log les in this directory ensures that the target does not use
 all of its storage memory to store old log les.
 A log le can be easily exported from the target by using the 
\begin_inset Quotes eld
\end_inset

Map network drive
\begin_inset Quotes erd
\end_inset

 feature in Windows.
 Simply map to the static ip of the target as shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Saucer map network"

\end_inset

.
 Remember to check the 
\begin_inset Quotes eld
\end_inset

Connect using dierent credentials
\begin_inset Quotes erd
\end_inset

 box.
 When prompted for a password, type in 
\begin_inset Quotes eld
\end_inset

admin
\begin_inset Quotes erd
\end_inset

 as the user and leave the password blank as shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Saucer credentials"

\end_inset

.
 The 
\begin_inset Quotes eld
\end_inset

les/tmp
\begin_inset Quotes erd
\end_inset

 directory of the target is now available in the windows le explorer as
 seen in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Saucer log files"

\end_inset

.
\end_layout

\begin_layout Section
Charging the Traxxas LiPo Battery
\end_layout

\begin_layout Standard
Connect both the balancing plug and the main power plug to the charger before
 starting a charge.
 Then place the battery in the ame resistant bag.
 Ensure that the charger is set to LiPo mode before pressing start.
 The charging indicator will turn green when the battery is fully charged.
\end_layout

\begin_layout Standard
Discharging the battery lower than 9V can destroy it or lead to reduced
 capacity and performance.
 It is therefore recommended that the battery should be charged when reaching
 a voltage of 11.1.
 The voltage of the battery can be measured with a voltmeter on the balancing
 plug.
 Using the ground wire in the balancing plug, the voltage of each of the
 cells can be measured from three remaining wires in the plug.
 If the LiPo battery is discharged below 9V it will not charge in LiPo mode.
 It is therefor wise to stay well above this limit.
 Should this happen, the battery can be charged in 
\begin_inset Quotes eld
\end_inset

NIMh
\begin_inset Quotes erd
\end_inset

 mode for maximum 10 seconds.
 This has proved to be eective for getting the voltage above 9V and able
 to charge in LiPo mode again.
 However it should be stressed that this measure be used with extremea caution
 and only as a last resort.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
ROV Neptunus
\end_layout

\begin_layout Standard
k
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
System interfacing
\end_layout

\begin_layout Plain Layout
work space
\end_layout

\begin_layout Subsubsection
Development for new algorithms in modules in Simulink
\end_layout

\begin_layout Subsubsection
Development with structural changes in I/O or LabVIEW UI
\end_layout

\begin_layout Plain Layout
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Deploying basic VI
\end_layout

\begin_layout Enumerate
Open LabVIEW
\end_layout

\begin_layout Enumerate
Create project
\end_layout

\begin_layout Enumerate
Blank project
\end_layout

\begin_layout Enumerate
In the left pane tree, right-click Project: XXX, New -> Targets and devices
\end_layout

\begin_layout Enumerate
Keep setting Existing target or device, Discover an existing target(s) or
 device(s)
\end_layout

\begin_layout Enumerate
In the tree, expand Real-Time CompactRIO, wait for search and select the
 cRIO
\end_layout

\begin_layout Enumerate
In the Project Explorer, drag and drop the VI to the device
\end_layout

\begin_layout Enumerate
Right-click the VI, Run
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Plain Layout
NI VeriStand FPGA-Based I/O Interface Tools https://decibel.ni.com/content/docs/DO
C-13815
\end_layout

\begin_layout Plain Layout
Integrating and Executing Models http://zone.ni.com/reference/en-XX/help/372846G-0
1/veristand/models_overview/
\end_layout

\begin_layout Plain Layout
Considerations for Integrating Models from The MathWorks, Inc.
 Simulink® Software (Model Interface Toolkit) http://zone.ni.com/reference/en-XX/h
elp/374160A-01/vsmithelp/mit_models_mdl/
\end_layout

\begin_layout Plain Layout
Using Models from The MathWorks, Inc.
 Simulink® Software (Model Interface Toolkit) http://zone.ni.com/reference/en-XX/h
elp/374160A-01/vsmithelp/mit_model_from_mdl/
\end_layout

\begin_layout Plain Layout
Simulation Models http://zone.ni.com/reference/en-XX/help/372846G-01/veristand/sim
ulation_models_se/
\end_layout

\begin_layout Plain Layout
Developing a PWM Interface using LabVIEW FPGA http://www.ni.com/white-paper/3254/e
n/
\end_layout

\begin_layout Plain Layout
Using LabVIEW VIs as Models http://zone.ni.com/reference/en-XX/help/372846G-01/ver
istandmerge/model_from_lv/
\end_layout

\begin_layout Plain Layout
\begin_inset Newpage newpage
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Part
\begin_inset CommandInset label
LatexCommand label
name "part: Lab exercises"

\end_inset

TMR4243 exercises and expected results
\end_layout

\begin_layout Plain Layout
General report requirements.
\end_layout

\begin_layout Chapter
Pendulum lab
\end_layout

\begin_layout Plain Layout
Adjust Simulink model for VeriStand.
\end_layout

\begin_layout Plain Layout
Deploy
\end_layout

\begin_layout Plain Layout
Create suitable workspace
\end_layout

\begin_layout Plain Layout
Actuate fan manually.
\end_layout

\begin_layout Plain Layout
Simulate to get same results as Simulink.
\end_layout

\begin_layout Plain Layout
Export data
\end_layout

\begin_layout Plain Layout
Try with handed out model (surprises).
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Chapter
Internal dynamics lab
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Chapter
Estimation lab
\end_layout

\begin_layout Section
Objective
\end_layout

\begin_layout Plain Layout
Teste konseptet, tau inputt,
\end_layout

\begin_layout Section
Theory and simulation
\end_layout

\begin_layout Plain Layout
Pure sway and surge dampings
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
d_{\text{pure surge}}=d_{11}u\label{eq: pure surge damping}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
d_{\text{pure sway}}=d_{22}v\label{eq: pure sway damping}
\end{equation}

\end_inset

Common DP model
\begin_inset Formula 
\begin{equation}
d_{11}\left(u\right)=-X_{u}-X_{\left\vert u\right\vert u}\left\vert u\right\vert -X_{uuu}u^{2}\label{eq: Fossen d_11}
\end{equation}

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
d_{22}\left(v,r\right)=-Y_{v}-Y_{\left\vert v\right\vert v}\left\vert v\right\vert -Y_{vvv}v^{2}-Y_{\left\vert r\right\vert v}\left\vert r\right\vert \label{eq: Fossen d_22}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
however, Fitting the drag force to experiemtal results yields the best fit
 for
\begin_inset Formula 
\begin{equation}
d_{11}\left(u\right)=-X_{u}-X_{uu}u-X_{uuu}u^{2}\label{eq: CSE1 HIL d_11}
\end{equation}

\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula 
\begin{equation}
d_{22}\left(v\right)=-Y_{v}-Y_{vv}v-Y_{vvv}v^{2}\label{eq: CSE1 HIL d_22}
\end{equation}

\end_inset

with parameters as listed in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: CSE1-hydrodynamic"

\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" rightline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Surge
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" leftline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Plain Layout
Sway
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{u}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.6555$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{v}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1.330$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{uu}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.3545$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{vv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-2.776$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X_{uuu}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-3.7870$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Y_{vvv}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-64.910$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: CSE1-hydrodynamic"

\end_inset

CSE1 hydrodynamic damping parameters
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Tasks
\end_layout

\begin_layout Enumerate
Use 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq: CSE1 HIL d_11"

\end_inset

 to find the thurst required to achieve 
\begin_inset Formula $0.6\text{ m/s}$
\end_inset

 and 
\begin_inset Formula $-0.6\text{ m/s}$
\end_inset

 in surge velocity.
 Equivalently with 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq: CSE1 HIL d_22"

\end_inset

 and velocities 
\begin_inset Formula $0.3\text{ m/s}$
\end_inset

 and 
\begin_inset Formula $-0.3\text{ m/s}$
\end_inset

 in sway.
\end_layout

\begin_deeper
\begin_layout Plain Layout
\begin_inset Formula 
\[
X=-X_{u}u-X_{uu}u^{2}-X_{uuu}u^{3}
\]

\end_inset


\begin_inset Formula 
\[
Y=-Y_{v}v-Y_{vv}v^{2}-Y_{vvv}v^{3}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Motion control
\end_layout

\begin_deeper
\begin_layout Plain Layout
switche mellom sway og surge fixed, alltid rotasjon fixed
\end_layout

\end_deeper
\begin_layout Enumerate
Surge hydrodynamics
\begin_inset Formula $\left[\begin{array}{c}
X_{\dot{u}}\\
X_{u}\\
X_{\left|u\right|u}
\end{array}\right]$
\end_inset


\end_layout

\begin_deeper
\begin_layout Plain Layout
design reasonable towing input
\end_layout

\end_deeper
\begin_layout Enumerate
Sway hydrodynamics
\begin_inset Formula $\left[\begin{array}{c}
Y_{\dot{v}}\\
Y_{v}\\
Y_{\left|v\right|v}
\end{array}\right]$
\end_inset


\end_layout

\begin_layout Enumerate
Real surge towing data
\begin_inset Formula $\left[\begin{array}{c}
X_{u}\\
X_{\left|u\right|u}
\end{array}\right]$
\end_inset


\end_layout

\begin_layout Subsection
Specific report requirements
\end_layout

\begin_layout Section
Hardware-in-the-loop simulation
\end_layout

\begin_layout Subsection
Tasks
\end_layout

\begin_layout Enumerate
Motion control
\end_layout

\begin_deeper
\begin_layout Plain Layout
discrete and switcing controller
\end_layout

\end_deeper
\begin_layout Enumerate
Real-time application configuration 
\end_layout

\begin_deeper
\begin_layout Enumerate
Create a VeriStand simulation project including the compiled control system
 ctrl_student.out and the CSE1 HIL model.
 i.
 Map control signals and measurements according to Tables 1 and 2, respectively.
\end_layout

\begin_layout Enumerate
Develop a suitable graphical user interface.
\end_layout

\end_deeper
\begin_layout Enumerate
Simulate to estimate surge, sway and yaw hydrodynamic parameters separately
 with the discrete controller as control input.
 Suitable velocity thresholds are u = 0; 25, v = 0; 20 and r = 0; 30.
 Keep CSE1 within the line f(x; y) j1 x 7:5; y = 0:25g to ensure position
 measurements.
\end_layout

\begin_layout Subsection
Specific report requirements
\end_layout

\begin_layout Section
Model scale testing
\end_layout

\begin_layout Plain Layout
HIL
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Chapter
The maneuvering lab
\end_layout

\begin_layout Plain Layout
\begin_inset Note Note
status open

\begin_layout Plain Layout

\series bold
Forslag fra Roger
\series default
 
\end_layout

\begin_layout Itemize
Estimere pivot point
\end_layout

\begin_layout Itemize
Estimere bølgefrekvens og bølgehøyde??
\end_layout

\begin_layout Itemize
Tuning PID parametere
\end_layout

\begin_layout Itemize
Analysere agressivitet ved ulik tuning
\end_layout

\begin_layout Itemize
Analysere og teste notch effekt i bølgefilter
\end_layout

\begin_layout Itemize
Thrust allocation
\end_layout

\begin_layout Itemize
Lyapunov function.
 UGES 
\begin_inset Formula $\rightarrow$
\end_inset

 estimate convergence rate 
\begin_inset Formula $\rightarrow$
\end_inset

 simulate convergence rate 
\begin_inset Formula $\rightarrow$
\end_inset

 test convergence rate
\end_layout

\begin_layout Itemize
Bandwidth!
\end_layout

\begin_layout Plain Layout
From TMR 4243 and 4515
\end_layout

\begin_layout Itemize
Robust nonlinear control methods (different backstepping methods, ISS designs,
 sliding-mode designs, passivity-based control, nonlinear PID and integral
 control).
\end_layout

\begin_layout Itemize
Adaptive control designs for nonlinear systems (adaptive backstepping, gradient
 methods, L1 adaptive control, etc.)
\end_layout

\begin_layout Itemize
Maneuvering control theory and path-following control designs for marine
 vessels (path parameterization, path generation, guidance theories, and
 feedback control laws).
\end_layout

\begin_layout Itemize
Fault-diagnosis and fault tolerant control (failure-mode detection, fault
 isolation, and control redesign to detect and handle failures in equipment
 and processes).
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Part
\begin_inset CommandInset label
LatexCommand label
name "part: Equipment setup and configuration"

\end_inset

Laboratory Staff Guide
\end_layout

\begin_layout Chapter
cRIO-based control system setup
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sub: cRIO setup"

\end_inset

cRIO
\end_layout

\begin_layout Standard
The cRIO runs Wind River VxWorks real-time operating system.
\end_layout

\begin_layout Subsection
Ethernet ports
\end_layout

\begin_layout Standard
The cRIO has two Ethernet ports the primary communicates with the PC and
 the secondary with the Raspberry PI.
\end_layout

\begin_layout Subsubsection
Primary
\end_layout

\begin_layout Standard
Set fixed IP, set fixed IP on HIL-computers
\end_layout

\begin_layout Subsubsection
Enabling the secondary ethernet port
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
http://digital.ni.com/public.nsf/allkb/67F94BB93BCE32CF86257367006B3659?OpenDocumen
t
\end_layout

\begin_layout Plain Layout
http://www.ni.com/white-paper/6872/en/
\end_layout

\begin_layout Plain Layout
http://zone.ni.com/reference/en-XX/help/370984T-01/criodevicehelp/reading_channels
_crio/
\end_layout

\begin_layout Plain Layout
http://www.ni.com/white-paper/7103/en/
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Start 
\emph on
NI MAX
\end_layout

\begin_layout Enumerate
In the left pane tree, select the cRIO under 
\emph on
Remote Systems
\end_layout

\begin_layout Enumerate
Open the 
\emph on
Network Settings
\emph default
 tab (located at the bottom of the window)
\end_layout

\begin_layout Enumerate
Set 
\emph on
Adapter Mode
\emph default
 to 
\emph on
TCP/IP Network
\end_layout

\begin_layout Enumerate
Set 
\emph on
Configure IPv4 Address
\emph default
 to 
\emph on
Static
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 14.10.14.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
NI MAX - Network Settings
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: network settings"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Update cRIO software
\end_layout

\begin_layout Standard
To be able to run the models on the cRIO, the software version on the cRIO
 and PC must match.
 In addition you must install the NI Veristand Engine.
 Software changes on the cRIO is handled in NI Max.
\end_layout

\begin_layout Subsubsection
Update
\end_layout

\begin_layout Enumerate
Open NI Max
\end_layout

\begin_layout Enumerate
Find your cRIO on the left hand side and click it
\end_layout

\begin_layout Enumerate
Click Software, and then Add/Rem ove Software located on the top pane, see
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Software update 1"

\end_inset


\end_layout

\begin_layout Enumerate
A new window will now open.
 Choose the option that matches your LabVIEW/Veristand edition (in our case
 14.0 or 14.0.1) under LabVIEW Real-Time 14.0.0 and click next.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: NI MAX - Software Update 2"

\end_inset


\end_layout

\begin_layout Enumerate
Click next without making any changes
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: NI MAX - Software Update 1-3"

\end_inset


\end_layout

\begin_layout Enumerate
Click next without making any changes
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: NI MAX - Software Update 4"

\end_inset


\end_layout

\begin_layout Enumerate
Wait for the installtion to finish and the cRIO to reboot
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 14.12.35.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
NI MAX - Software Update 1
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Software update 1"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 14.12.51.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
NI MAX - Software Update 1
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: NI MAX - Software Update 2"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 14.13.03.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
NI MAX - Software Update 3
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: NI MAX - Software Update 1-3"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 14.15.22.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
NI MAX - Software Update 4
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: NI MAX - Software Update 4"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
NI Veristand Engine
\end_layout

\begin_layout Enumerate
Repeat step 1-3 from the previous guide
\end_layout

\begin_layout Enumerate
Now you choose Custom Software installation in the menu, see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: NI Veristand Engine installation 1"

\end_inset


\end_layout

\begin_layout Enumerate
Ignore the warning, See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: NI Veristand Engine installation 1-1"

\end_inset


\end_layout

\begin_layout Enumerate
Locate NI Veristand Engine 2014 0.0 and click install feature.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: NI Veristand Engine installation 1-2"

\end_inset


\end_layout

\begin_layout Enumerate
Click your way through the rest of the installation and let the cRIO reboot.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 14.20.27.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
NI MAX - NI Veristand Engine installation 1
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: NI Veristand Engine installation 1"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 14.20.39.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
NI MAX - NI Veristand Engine installation 1
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: NI Veristand Engine installation 1-1"

\end_inset

 
\end_layout

\end_inset


\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 14.21.07.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
NI MAX - NI Veristand Engine installation 1
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: NI Veristand Engine installation 1-2"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Create-FPGA-target"

\end_inset

Create FPGA target and XML
\end_layout

\begin_layout Standard
If you do not haav a Veristand FPGA target at your disposal, follow the
 steps below.
 If you have a target available and just need to install it in NI Veristand,
 please jump to the next subsection
\end_layout

\begin_layout Enumerate
Open LabVIEW and create new project.
 We have done this in LabVIEW 2013 because of some instalation issues with
 LabVIEW 2014, but the procedure should be the same for both editions.
\end_layout

\begin_layout Enumerate
Choose NI Veristand FPGA Project in project templates and proceed.
\end_layout

\begin_layout Enumerate
Choose CompactRIO Reconfiguarble Embedded System and click next.
\end_layout

\begin_layout Enumerate
You will now get the choice between letting LabVIEW detect your cRIO system
 or configure it yourself.
 If you are connected to the cRIO and it has all of the I/O ports connected,
 the option 
\begin_inset Quotes eld
\end_inset

Discover existing system
\begin_inset Quotes erd
\end_inset

 is simpler and therefore recommneded.
 If you do not have your cRIO connected choose 
\begin_inset Quotes eld
\end_inset

Create new system
\begin_inset Quotes erd
\end_inset

, this is the version that will be worked through here.
\end_layout

\begin_layout Enumerate
Select your controller, in our case cRIO-9024.
\end_layout

\begin_layout Enumerate
Select your FPGA target, in our case cRIO-9113.
\end_layout

\begin_layout Enumerate
Then you select your I/O modules to the correct slots.
 In our case NI 9215 in slot 1 and NI 9474 in slot 4.
\end_layout

\begin_layout Enumerate
You are now finished with configuring your project.
 Press next.
\end_layout

\begin_layout Enumerate
The project menu will now appear and should look something like Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Create Labview FPGA target and XML-10"

\end_inset

.
 Select the LabVIEW VI as demonstrated our is called Custom Personality
 FPGA.vi
\end_layout

\begin_layout Enumerate
The UI window will now present itself, select window and show block diagram.
\end_layout

\begin_layout Enumerate
You should now see a block diagram similar to Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Create Labview FPGA target and XML-11"

\end_inset

.
 You will now have to redesign this to look like Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Create Labview FPGA target and XML-12"

\end_inset

.
 This will be valid for our system, if you have different I/O modules the
 block diagram need to reflect this.
\end_layout

\begin_layout Enumerate
Now, return to the Project explorer and select Build Specifications and
 Custom Personality FPGA
\end_layout

\begin_layout Enumerate
A new window will open.
 Check that the name and project path is correct and press build.
\end_layout

\begin_layout Enumerate
Select your preferred compile server.
 The compilation process will take quite some time (approx 15-30 min).
\end_layout

\begin_layout Enumerate
When the compilation process is finished, the last step is to edit the automatic
ally generated XML file.
 You will now have to find you project directory in Windows.
 Here there will be a folder called bitfiles which contains the files you
 compiled in the last step, there will also be a .XML file.
 The point of editing this file is to match the actually compiled VI, meaning
 the packets must match the connected I/O.
 The recommended way to edit the file is to copy our XML file from: Dropbox
\backslash
TMR4243 - LAB
\backslash
04 cRIO software
\backslash
FPGA IO.
 You will have to make sure that the name of your bitfile matches the name
 in the XML file as seen in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Create Labview FPGA target and XML-17"

\end_inset

, also make sure the I/O modules matches your setup.
\end_layout

\begin_layout Enumerate
Copy the bitfiles from the bitfile folder to the level above so that the
 bitfile aand the XML file is in the same folder.
\end_layout

\begin_layout Standard
Documentation: 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://decibel.ni.com/content/docs/DOC-13815
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.21.16.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 1
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-1"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.23.23.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 2
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-2"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.23.41.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 3
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-3"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.23.58.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML -4
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-4"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.24.31.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 5
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-5"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.24.43.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 6
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-6"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.25.37.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 7
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-7"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.25.54.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 8
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-8"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.28.17.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML -9
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-9"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.28.41.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 10
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-10"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.29.04.png
	scale 45
	rotateAngle -90

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 11
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-11"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 20.07.43.png
	scale 45
	rotateAngle -90

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 12
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-12"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.52.25.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 13
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-13"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.53.01.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 14
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-14"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 19.53.25.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 15
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-15"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-16 20.01.32.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 16
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-16"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Screenshots/Screenshot 2015-01-17 13.59.31.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Create Labview FPGA target and XML - 17
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Create Labview FPGA target and XML-17"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Veristand FPGA programmering
\end_layout

\begin_layout Standard
In order to access the analogue and digital I/O modules on our cRIO from
 Veristand, it is necessary to create a FPGA target in Labview with Labview
 and you will have to write a custom XML file.
\end_layout

\begin_layout Subsubsection
Install in veristand
\end_layout

\begin_layout Standard
The Veristand software does not recognize the physical I/O components of
 the cRIO.
 It is necessarry to write a specific FPGA mapping for the specific setup.
 This results in a XML file that maps the ports.
 
\end_layout

\begin_layout Standard
To add this file to your Veristand project, enter the system explorer and
 find the FPGA pane under 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textit{
\end_layout

\end_inset

targets
\backslash
controller
\backslash
hardware
\backslash
chassis
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

, as seen in figure 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
ref{fig: fpga1}
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename fpga1.png
	scale 45

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
FPGA1
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: fpga1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The next step is to find your XML file.
 In this case called cRIO-9113 Ex, it is very important that the XML file
 is placed on level above the FPGA bitfile folder in the directory system,
 as the files are really being used are the FPGA bitfiles.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename fpga2.png
	scale 45

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
FPGA2
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: fpga2"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The menu in should now look something like Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: fpga2"

\end_inset

, here you can see the analogue input signals and the digital output PWM
 signals.
 These can again be linked to other signals as seen in Figure
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand mappings"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename fpga3.png
	scale 45

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
FPGA3
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: fpga3"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
PWM
\end_layout

\begin_layout Paragraph
Ticks og sånt
\end_layout

\begin_layout Standard
tick = FPGA clock pulse
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\text{tick in seconds}=\frac{1}{\text{frequency}}=\frac{1}{40MHz}=\frac{1}{40*10^{6}}=25*10^{-}9=25ns
\]

\end_inset


\end_layout

\begin_layout Standard
output at 50 Hz demands output every 
\begin_inset Formula 
\[
\frac{40MHz}{50Hz}=\frac{40*10^{6}}{50}=800000tick
\]

\end_inset


\end_layout

\begin_layout Paragraph
VeriStand FPGA programming
\end_layout

\begin_layout Standard
LabView -> Create project -> All -> NI VeriStand FPGA project -> Compact
 RIO -> Discover existing system -> Velge eget utstyr -> Vente på discovering
 -> I Project explorer *.vi (er bitfilen) *.fpgaconfig (egentlig XML) Endre
 på *.vi Fjerne overføldige pakker Oppdatere antall pakker i XML-filen og
 fjerne pakker som ikke er aktuelle, oppdatere tall på beholdte pakker.
 Kompiler
\end_layout

\begin_layout Standard
Kopier bit-file ut i samme mappe som *.fpgaconfig I System exlporer, FPGA
 -> Add FPGA target -> Finne *.fpgaconfig
\end_layout

\begin_layout Paragraph
Analog input
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
todo{
\end_layout

\end_inset

Eirik: FPGA-greier osv
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Installing custom device driver
\end_layout

\begin_layout Paragraph
Create
\end_layout

\begin_layout Standard
Torgeir Wahl has built the custom device driver for taking Oqus and PS3
 controller input to Veristand
\end_layout

\begin_layout Paragraph
\begin_inset CommandInset label
LatexCommand label
name "sub: Installing custom device driver"

\end_inset

Install
\end_layout

\begin_layout Standard
In order to use a RPi to send joystick commands to the cRIO it is necessary
 to build a custom device driver.
 In our case Torgeir Wahl has built a driver, and this guide will show how
 to install the driver.
\end_layout

\begin_layout Standard
The first step is to copy the whole directory (folder named WL_Joystick)
 of the custom device driver into the correct directory on your computer:
\end_layout

\begin_layout Standard
C:
\backslash
Users
\backslash
Public
\backslash
Documents
\backslash
National Instruments
\backslash
NI VeriStand 2014
\backslash
Custom Devices
\end_layout

\begin_layout Standard
The directory should now contain something like Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: custom device folder"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename custom devices folder.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Custom device folder
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: custom device folder"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The next step is to add custom device to your project.
 This is done in the system explorer, which is found as seen in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand launch system explorer"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand launch system explorer.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
VeriStand launch system explorer
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand launch system explorer"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
When in the system explorer, adding the custom device should be as simple
 as right clicking the custom device pane and choosing WL_Joystick, as in
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: custom device selection"

\end_inset

.
 If you do not find the custom device WL_Joystick, the most likely problem
 is that the placement of the custom device folder from step 1 is wrong.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand custom driver select.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Custom device selection
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: custom device selection"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
If the installation is successful you should be able to see WL_Joystick
 folder under custom devices as seen in the red box in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand confirmation"

\end_inset

.
 Here you will also see the different inputs from the custom device, in
 this case it is joystick axis.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand mapping.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
VeriStand
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand confirmation"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To connect the joystick to the input ports of the Simulink model.
 You open the system configuration mappings (click the button marked by
 the arrow in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand confirmation"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand mapping2.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
VeriStand System Configuration Mappings
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand mappings"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
You the simply find the ports you would like to connect, mark them and click
 the connect button.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand mappings"

\end_inset

 a joystick output is connected to a input port on the Simulink model.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sub: RPi setup"

\end_inset

Raspberry Pi
\end_layout

\begin_layout Standard
the unit is configured with Raspbian Linux-kernel-based operating system
 
\end_layout

\begin_layout Subsection
Raspbian installation and setup
\end_layout

\begin_layout Standard
This section describes how to install and access the Raspbian operating
 system on the RPi from a Windows computer.
 The operations are also possible from an OSX or Linux computer.
\end_layout

\begin_layout Subsubsection
Download operating system and utilities
\end_layout

\begin_layout Standard
Download and extract the newest Raspbian
\begin_inset Foot
status open

\begin_layout Plain Layout
raspberrypi.org/downloads
\end_layout

\end_inset

 operating system (OS) image.
\end_layout

\begin_layout Standard
Necessary utilities for the setup are
\end_layout

\begin_layout Itemize
Win32 Disk Imager
\begin_inset Foot
status open

\begin_layout Plain Layout
sourceforge.net/projects/win32diskimager
\end_layout

\end_inset

 to write the OS image to the RPi SD card
\end_layout

\begin_layout Itemize
Advanced IP scanner
\begin_inset Foot
status open

\begin_layout Plain Layout
by Famatech, advanced-ip-scanner.com
\end_layout

\end_inset

 to find the RPi address on the network 
\end_layout

\begin_layout Itemize
Putty terminal emulator
\begin_inset Foot
status open

\begin_layout Plain Layout
www.chiark.greenend.org.uk/~sgtatham/putty/download.html
\end_layout

\end_inset

 for SSH connection
\end_layout

\begin_layout Itemize
WinSCP
\begin_inset Foot
status open

\begin_layout Plain Layout
by Martin Prikryl, winscp.net/eng/download.php
\end_layout

\end_inset

 for file transfer
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt" special=">{\bfseries}l">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Windows
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Linux, OSX
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Win32 Disk Imager
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
dd
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Advanced IP scanner
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
nmap
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Putty
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ssh
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
WinSCP
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sftp
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
RPi installation and setup utilities
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset CommandInset label
LatexCommand label
name "tab: RPi utilities"

\end_inset

 
\end_layout

\end_inset

See Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: RPi utilities"

\end_inset

 for a list of the equivalent software for OSX and Linux.
\end_layout

\begin_layout Subsubsection
Write image to SD card
\end_layout

\begin_layout Standard
Since the .iso file is raw, it needs to be written to the SD card in way
 that makes it bootable.
 Win32 Disk Imager does this.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Rpi_DiskImager.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Disk Imager
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Disk Imager"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Run the program as administrator.
 Select the correct image file and device, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Disk Imager"

\end_inset

.
 Make sure that you have slected the correct drive before you push 
\noun on
Write
\noun default
.
\end_layout

\begin_layout Standard
Once the write is complete, insert the SD card in the RPi and boot.
\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sub: Terminal access"

\end_inset

Terminal access
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
http://www.hobbytronics.co.uk/raspberry-pi-ssh
\end_layout

\begin_layout Plain Layout
http://hertaville.com/2012/09/27/raspbian-raspberry-pi/
\end_layout

\end_inset


\end_layout

\begin_layout Standard
RPi can be accessed through the network, i.e.
 without having to directly connect a monitor and keyboard.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h!
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename advancedIPscanner.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Advanced IP Scanner
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Advanced IP Scanner"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
At first boot, the RPi by default waits to be assigned an IP address by
 DHCP.
 If this address is not known, scan the network with Advanced IP Scanner.
 It is advicible to sort the results by manufacturer since it is fixed (
\shape italic
Raspberry Pi Foundation
\shape default
).
 The name is typically 
\emph on
raspberrypi
\emph default
.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Advanced IP Scanner"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Rpi_remote_access1.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Putty settings
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Putty settings"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Once the IP is known, it is specified in the Putty settings, as in Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Putty settings"

\end_inset

, and a connection can be opened.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Rpi_remote_access2.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
SSH connection
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: SSH connection"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The default login is 
\family typewriter
pi
\family default
, and the default password 
\family typewriter
raspberry
\family default
.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: SSH connection"

\end_inset

 shows the terminal output on first login.
\end_layout

\begin_layout Subsubsection
Finalize configuration
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Rpi_finalize_install.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
RPi configuration tool
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig: RPi configuration tool"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Enter the
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo raspi-config
\backslash
end{verbatim}
\end_layout

\end_inset

command to start the RPi Software Configuration Tool, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: RPi configuration tool"

\end_inset

.
 Use the menu to apply the following
\end_layout

\begin_layout Enumerate
Update configuration tool: 8 Advanced Options 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textgreater 
\end_layout

\end_inset

 A9 Update
\end_layout

\begin_layout Enumerate
Change password: 2 Change User Password
\end_layout

\begin_layout Enumerate
Expand filesystem: 1 Expand Filesystem 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textgreater 
\end_layout

\end_inset

 Finish
\end_layout

\begin_layout Standard
Exit the configuration tool and select 
\noun on
Yes
\noun default
 for reboot.
 Reconnect through Putty.
\end_layout

\begin_layout Standard
Finally, update the repository package lists and upgrade all packages currently
 installed on the RPi:
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo apt-get update
\end_layout

\begin_layout Plain Layout

sudo apt-get upgrade -y
\backslash
end{verbatim}
\end_layout

\end_inset

This process took approximately 10 minutes on a 90 Mbps internet connection.
\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sub: Transfer files to RPi"

\end_inset

Transfer files to RPi from computer
\end_layout

\begin_layout Standard
WinSCP can be used to transfer files to the RPi.
 This is useful for instance when transferring code, or when the RPi is
 not directly connected to the internet.
\end_layout

\begin_layout Subsubsection
Set fixed IP address
\end_layout

\begin_layout Standard
When the RPi is connected directly to the cRIO or computer, a fixed IP is
 necessary since there is no DHCP server in that network.
 During most of this setup, however, it is preferable to keep the default
 DHCP assigned IP setting.
\end_layout

\begin_layout Standard
To set a fixed IP
\end_layout

\begin_layout Enumerate
Open the network interface configuration information file for editing
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo nano /etc/network/interfaces
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Alter the eth0 settings from 
\family typewriter
dhcp
\family default
 to 
\family typewriter
static
\family default
 and add address and netmask as
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}auto eth0
\end_layout

\begin_layout Plain Layout

iface eth0 inet static
\end_layout

\begin_layout Plain Layout

   address 192.168.1.22
\end_layout

\begin_layout Plain Layout

   netmask 255.255.255.0
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Save the changes by the key combination 
\noun on
Ctrl+X
\noun default
.
\end_layout

\begin_layout Standard
The new IP is applied on the next reboot.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Sixaxis installation and configuration
\end_layout

\begin_layout Standard
This section describes how to install and configure the Sixaxis gamepad
 for Bluetooth connection to the RPi, and how to add a server for sending
 joystick signals to the cRIO.
\end_layout

\begin_layout Subsubsection
Download and install bluetooth support
\end_layout

\begin_layout Standard
BlueZ is the official Linux Bluetooth stack.
 It provides support for core Bluetooth layers and protocols.
\end_layout

\begin_layout Standard
To download and install, type
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo apt-get install bluez-utils bluez-compat bluez-hcidump
\end_layout

\begin_layout Plain Layout

   libusb-dev libbluetooth-dev joystick checkinstall -y
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The process takes a few minutes.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename rpi_hciconfig.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Bluetooth configuration tool
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig: RPi hciconfig"

\end_inset

 
\end_layout

\end_inset

To confirm the installation, use the 
\family typewriter
hciconfig
\family default
 command to print name and basic information about Bluetooth devices installed
 in the system.
 The output should include 
\family typewriter
UP RUNNING PSCAN
\family default
, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: RPi hciconfig"

\end_inset

.
 If instead it says 
\family typewriter
DOWN
\family default
, some error har occured.
\end_layout

\begin_layout Standard
Most experienced errors were due to typos.
\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "par: Bluetooth-pairing"

\end_inset

Bluetooth pairing
\end_layout

\begin_layout Standard
Sixaxis does not support the standard Bluetooth paring prcedure, instead,
 pairing is done over USB.
 The 
\family typewriter
sixpair
\family default
 command-line utility
\begin_inset Foot
status open

\begin_layout Plain Layout
by Pabr Technologies, www.pabr.org
\end_layout

\end_inset

 searches USB buses for Sixaxis devices and tells them to connect to a new
 Bluetooth master.
\end_layout

\begin_layout Standard
Download and compile the program by the following commands:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}wget http://www.pabr.org/sixlinux/sixpair.c
\end_layout

\begin_layout Plain Layout

gcc -o sixpair sixpair.c -lusb
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Connect the Sixaxis by USB before running the paring utility
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo ./sixpair
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The output should be similar to
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}Current Bluetooth master: 00:02:72:BF:BC:8F
\end_layout

\begin_layout Plain Layout

Setting master bd_addr to: 00:02:72:BF:BC:8F
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The addresses at the end of each line will only be the same if you have
 already paired the Sixaxis with the Bluetooth dongle.
 First time they will be different.
\end_layout

\begin_layout Standard
The Sixaxis USB cable may now be disconnected.
\end_layout

\begin_layout Subsubsection
Joystick manager system service
\end_layout

\begin_layout Standard

\family typewriter
QtSixA
\begin_inset Foot
status open

\begin_layout Plain Layout
the Sixaxis Joystick Manager by falkTX, qtsixa.sourceforge.net
\end_layout

\end_inset


\family default
 reads the Sixaxis signals and makes them available to other programs.
 This program needs to run automatically whenever the RPi is booted.
\end_layout

\begin_layout Standard
To download the program, type
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}wget http://sourceforge.net/projects/qtsixa/files/QtSixA%201.5.1/QtS
ixA-1.5.1-src.tar.gz
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To install, type
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}tar xfvz QtSixA-1.5.1-src.tar.gz
\end_layout

\begin_layout Plain Layout

cd QtSixA-1.5.1/sixad
\end_layout

\begin_layout Plain Layout

make
\end_layout

\begin_layout Plain Layout

sudo mkdir -p /var/lib/sixad/profiles
\end_layout

\begin_layout Plain Layout

sudo checkinstall -y
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Update the system service list with sixad driver and reboot
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo update-rc.d sixad defaults
\end_layout

\begin_layout Plain Layout

sudo reboot
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Reboot the RPi.
\end_layout

\begin_layout Plain Layout
To test the program, turn on the Sixaxis (round PS button in the middle)
 and start the service
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo sixad -start
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Note Note
status open

\begin_layout Plain Layout
ctrl-c
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
To test the program, turn on the Sixaxis (round PS button in the middle)
 and start the test program
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo jstest /dev/input/js0
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The terminal should now fill up with numbers that change as you move the
 analogue sticks and press the buttons on the Sixaxis.
 Exit the program by the key combination 
\noun on
Ctrl+C
\noun default
.
\end_layout

\begin_layout Paragraph
\begin_inset Note Note
status open

\begin_layout Paragraph
Running PS3 service at boot
\end_layout

\begin_layout Plain Layout
To get the programme to run at boot type:
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo update-rc.d sixad defaults
\end_layout

\begin_layout Plain Layout

sudo reboot
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
After boot, wait about a minute to make let the service start, write in
 sudo jstest /dev/input/js0 to check if the controller works.
 Note: the controller must be on
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Now it is time to change the serial port settings on the PI.
 To do this we have to change two files.
 First step is to run a text editor as administrator.
 If you are in the graphical user interface type (write startx to load graphical
 interface)
\end_layout

\begin_layout Plain Layout
sudo leafpad
\end_layout

\begin_layout Plain Layout
Then navigate to the root directory /etc and fin the file inittab.
 Open the file and navigate to the last line which should read:
\end_layout

\begin_layout Plain Layout
T0:23:respawn:/sbin/getty -L ttyAMA0 115200 vt100
\end_layout

\begin_layout Plain Layout
Change this to:
\end_layout

\begin_layout Plain Layout
#T0:23:respawn:/sbin/getty -L ttyAMA0 115200 vt100
\end_layout

\begin_layout Plain Layout
Only adding # at the start and save the file.
\end_layout

\begin_layout Plain Layout
The next file you should alter is in the /boot directory and is called cmdline.tx
t
\end_layout

\begin_layout Plain Layout
The contents of the file look like this
\end_layout

\begin_layout Plain Layout
dwc_otg.lpm_enable=0 console=ttyAMA0,115200 kgdboc=ttyAMA0,115200
\end_layout

\begin_layout Plain Layout
console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 elevator=deadline rootwait
\end_layout

\begin_layout Plain Layout
Remove all references to ttyAMA0 (which is the name of the serial port)
 marked in red above.
 The file will now look like this
\end_layout

\begin_layout Plain Layout
dwc_otg.lpm_enable=0 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4
\end_layout

\begin_layout Plain Layout
elevator=deadline rootwait
\end_layout

\begin_layout Plain Layout
Now you can test your python code either to see if it works either in the
 python environment or in terminal.
 Copy and paste ps3-final python.
 Test in IDLE.
\end_layout

\begin_layout Plain Layout
The next step is to get the script running from boot.
 First we disable the login at start-up.
 To do this we again enter the file /etc/inittab Here we find the line below
 and change by adding –autologin {Username} as seen below (with my username
 pi).
 
\end_layout

\begin_layout Plain Layout
1:2345:respawn:/sbin/getty --noclear 38400 tty1
\end_layout

\begin_layout Plain Layout
1:2345:respawn:/sbin/getty --autologin pi --noclear 38400 tty1
\end_layout

\begin_layout Plain Layout
Final step is to make the script run at boot.
 This is accomplished by changing the hidden file .bashrc in your home directory
 (/home/pi/.bashrc) adding the command to start your python script at the
 end of the file.
 In my case
\end_layout

\begin_layout Plain Layout
sudo python serial_PS3_final.py
\end_layout

\begin_layout Plain Layout
Now the Raspberry PI should be sending PS3 control signals at start-up.
 The string sent out by serial_PS3_final.py is in the order:
\end_layout

\begin_layout Plain Layout
[left_x_aks, left_y_aks, right_x_aks, right_y_aks, arrow_up, arrow_rigth,
 arrow_down, arrow_left, L2, R2, L1, R1, triangle, circle, x, square]
\end_layout

\begin_layout Plain Layout
The PS3 controller has to be turned on when the PI is started up.
 And it takes about 1 minute from power up until the script is running.
 Nothing says that the script is supposed to start when playstation is activated
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Joystick signal server
\end_layout

\begin_layout Standard
A server must run to make joystick signals available over the RPi ethernet
 port.
 This should also start whenever the RPi is booted.
\end_layout

\begin_layout Standard
Transfer the source file 
\family typewriter
jscont.c
\family default
 to the RPi (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Transfer files to RPi"

\end_inset

), then compile:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}g++ -o jscont jscont.c
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To verify that the program runs correctly, turn off (hold PS3 button for
 about 10 seconds) the previously paired Sixaxis and start the program
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}./jscont
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename RPi_jscont.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Joystick signal server test
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig: RPi joystick server"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The program should then wait until you turn on the Sixaxis before giving
 output simular to Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: RPi joystick server"

\end_inset

.
 To exit the server use the key combination 
\noun on
Ctrl+C
\noun default
.
\end_layout

\begin_layout Standard
Next, disable login at start-up in the bootup service description 
\family typewriter
inittab
\family default
:
\end_layout

\begin_layout Enumerate
Open the file for editing 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo nano /etc/inittab
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Change the line that reads 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}1:2345:respawn:/sbin/getty --noclear 38400 tty1
\backslash
end{verbatim}
\end_layout

\end_inset

 by adding 
\family typewriter
--autologin pi
\family default
 to get 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}1:2345:respawn:/sbin/getty --autologin pi --noclear 38400
 tty1
\backslash
end{verbatim}
\end_layout

\end_inset

 
\series bold
Warning:
\series default
 Typos here may result consequences hard to correct.
\end_layout

\begin_layout Enumerate
Save and exit the changes by the key combination 
\noun on
Ctrl+X
\noun default
.
\end_layout

\begin_layout Standard
Finally, add 
\family typewriter
jscont
\family default
 to the login execution file:
\end_layout

\begin_layout Enumerate
Open the file for editing 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo nano /home/pi/.bashrc
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
At the very end of the file, add 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{verbatim}sudo ./jscont
\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Save the changes by the key combination 
\noun on
Ctrl+X
\noun default
.
\end_layout

\begin_layout Standard
RPi should now be sending joystick signals at start-up.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Sources:
\end_layout

\begin_layout Enumerate
http://www.raspberrypi.org/help/noobs-setup/ 
\end_layout

\begin_layout Enumerate
http://www.raspberrypi.org/downloads/ 
\end_layout

\begin_layout Enumerate
https://www.sdcard.org/downloads/formatter_4/ 
\end_layout

\begin_layout Enumerate
http://mypiandi.blogspot.no/2012/12/retropie-sixaxis-over-bluetooth.html 
\end_layout

\begin_layout Enumerate
http://www.aonsquared.co.uk/the_dark_pi_rises 
\end_layout

\begin_layout Enumerate
http://dhoium3009.wordpress.com/raspberry-pi-connecting-multiple-ps3-controllers-v
ia-bluetooth/ 
\end_layout

\begin_layout Enumerate
https://github.com/petrockblog/RetroPie-Setup/wiki/Setting-up-a-PS3-controller
 
\end_layout

\begin_layout Enumerate
http://www.hobbytronics.co.uk/raspberry-pi-serial-port 
\end_layout

\begin_layout Enumerate
http://raspberrypi.stackexchange.com/questions/3873/auto-login-with-gui-disabled-i
n-raspbian 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Laptop
\end_layout

\begin_layout Standard
To ease the administration of the student computers, a virtual machine has
 been created that contains all the necessary software specified in Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Laptop software"

\end_inset

.
 The virtual machine (the guest guest, VM) can be run on any computer (the
 host machine) and on any operating system, that is supported by 
\emph on
VirtualBox
\emph default
.
 
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub: Laptop software"

\end_inset

Virtual machine image creation
\end_layout

\begin_layout Standard
Compatability between software is very important, See NI VeriStand Version
 Compatibility KnowlegeBase
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset Flex Flex:URL
status open

\begin_layout Plain Layout

http://digital.ni.com/public.nsf/allkb/2AE33E926BF2CDF2862579880079D751
\end_layout

\end_inset


\end_layout

\end_inset

.
\end_layout

\begin_layout Subsubsection
Order of installation
\end_layout

\begin_layout Enumerate
Microsoft .NET
\end_layout

\begin_layout Enumerate
Microsoft SDK
\end_layout

\begin_layout Enumerate
Matlab
\end_layout

\begin_layout Enumerate
Labview
\end_layout

\begin_layout Enumerate
Veristand
\end_layout

\begin_deeper
\begin_layout Enumerate
Including NI VeriStand Model Framework! This does not follow in the standard
 (full) install.
 Need to select 
\begin_inset Quotes eld
\end_inset

install with costomization
\begin_inset Quotes erd
\end_inset

 and then select it.
\end_layout

\end_deeper
\begin_layout Enumerate
Additional for model compilation
\end_layout

\begin_deeper
\begin_layout Enumerate
VxWorks:
\end_layout

\begin_deeper
\begin_layout Enumerate
WindRiver GNU Toolchain
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset Flex Flex:URL
status open

\begin_layout Plain Layout

ftp://ftp.ni.com/pub/devzone/epd/gccdist_vxworks6.3_gcc3.4.4.zip
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Real-Time Workshop software
\end_layout

\end_deeper
\begin_layout Enumerate
PharLap:
\end_layout

\begin_deeper
\begin_layout Enumerate
Microsoft Visual C++
\end_layout

\begin_layout Enumerate
The MathWorks, Inc.
 Real-Time Workshop® software
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub: virtualmachine"

\end_inset

Deploying the virtual machine
\end_layout

\begin_layout Subsubsection
Free disk space
\end_layout

\begin_layout Standard
The image is over 70 GB large.
 Sufficient space must be available on the harddisk.
\end_layout

\begin_layout Standard
Space may be freed by
\end_layout

\begin_layout Itemize
turning off Windows power settings Hibernate and Hybrid-sleep, and deleting
 the Hibernate file,
\end_layout

\begin_layout Itemize
reducing the size of the system virtual memory, and
\end_layout

\begin_layout Itemize
deleting unnecessary files.
\end_layout

\begin_layout Standard
See online tutorials on how to do this.
\end_layout

\begin_layout Subsubsection
Virtual Box
\end_layout

\begin_layout Standard
Virtual Box is a Virtual Machine environment from Oracle and under the GNU
 license.
 
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset Flex Flex:URL
status open

\begin_layout Plain Layout

 https://www.virtualbox.org
\end_layout

\end_inset


\end_layout

\end_inset

 After installation any number of virtual machines can be added to the system.
\end_layout

\begin_layout Subsubsection
MC Lab Virtual Machine
\end_layout

\begin_layout Standard
The virtual machine can be found on the ArcticDP server.
 Access at 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset


\backslash

\backslash
ArcticDPStation
\backslash
MC-Lab
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 or 
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset


\backslash

\backslash
129.241.140.194
\backslash
MC-Lab
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

, when connected to the ivt.ntnu.no network.
\end_layout

\begin_layout Standard
After unzipping on the host computers harddrive, the following steps have
 to be conducted in VirtualBox:
\end_layout

\begin_layout Enumerate
Add the virtual machine image to VirtualBox, as shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: VMBoxadd"

\end_inset

.
\end_layout

\begin_layout Enumerate
Adjust the settings of the virtual machine, such that it fits the host machine.
 The virtual machine is set up to run on the student lab computers.
 It will claim 2 processor cores and 10 GB of memory.
\end_layout

\begin_layout Enumerate
Start the virtual machine, as shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: VMBoxstart"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename VMBox1.jpg
	width 80text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Adding a virtual machine to VirtualBox 
\begin_inset CommandInset label
LatexCommand label
name "fig: VMBoxadd-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset Graphics
	filename VMBox2.jpg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Adding a virtual machine to VirtualBox 
\begin_inset CommandInset label
LatexCommand label
name "fig: VMBoxadd"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset


\begin_inset Graphics
	filename VMBox3.jpg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Start a virtual machine 
\begin_inset CommandInset label
LatexCommand label
name "fig: VMBoxstart"

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Common known problems
\end_layout

\begin_layout Enumerate

\emph on
VM's Matlab cannot find the license server
\emph default
: Make sure that the host computer is connected to the universities network.
 Make sure to use Eduroam on the host computer.
 Do not use the ntnuguest network.
 The network connections are 
\begin_inset Quotes eld
\end_inset

bridged
\begin_inset Quotes erd
\end_inset

 into the virtual machine.
 In case you cannot find the problem or in case Euduroam of NTNU is not
 available, you can use the Cisco VPN client installed on the VM.
 
\end_layout

\begin_layout Enumerate

\emph on
The VM cannot find the cRio
\emph default
: Go to the settings of the virtual machine (move your mouse down to the
 middle section of the bottom of the screen inside the VM).
 Go to the network settings and check out 
\begin_inset Quotes eld
\end_inset

Network adapter 2
\begin_inset Quotes erd
\end_inset

.
 Is it 
\begin_inset Quotes eld
\end_inset

bridged
\begin_inset Quotes erd
\end_inset

 to the correct network adapter of the host machine? Sometimes, after a
 driver update on the host machine, you have to set that right again.
 Second thing is that if you use the Cisco VPN client to connect to NTNU,
 you have to tick 
\begin_inset Quotes eld
\end_inset


\emph on
Allow local (LAN) access when using VPN
\emph default

\begin_inset Quotes erd
\end_inset

, as shown in Figure 
\begin_inset CommandInset label
LatexCommand label
name "fig: VPNtick"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename VMVPNProb.jpg
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Cisco VPN client LAN option
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
CS Enterprise I
\end_layout

\begin_layout Standard
Increased servo percentage results in clockwise? motion.
\end_layout

\begin_layout Standard
Hystersis on motors
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename CSE1 control software.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
CSE1 component communication
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: software module communication-1"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename innmat_CSE1.png
	width 95text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
CSE1 - Hardware 
\begin_inset CommandInset label
LatexCommand label
name "fig: CSE1 hardware"

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
tikzstyle{blokk}= [draw, text width=2.5em, text centered, thin]
\end_layout

\begin_layout Plain Layout

%
\backslash
tikzstyle{blokk}= [draw,       text centered, minimum height=1em, rounded
 corners]
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout

	
\backslash
node (observer) [blokk] {
\backslash
tiny observer}; 
\backslash
&
\end_layout

\begin_layout Plain Layout

	
\backslash
node (blank) [blokk, right=of observer] {
\backslash
tiny ?};
\end_layout

\begin_layout Plain Layout

	
\backslash
node (thrust_allocation) [blokk, right=of blank] {
\backslash
tiny Thrust allocation};
\end_layout

\begin_layout Plain Layout

	
\backslash
node (command2force) [blokk, right=of thrust_allocation] {
\backslash
tiny Command to force mapping};
\end_layout

\begin_layout Plain Layout

	
\backslash
node (thrust_configuration) [blokk, right=of command2force] {
\backslash
tiny Thrust configuration};
\end_layout

\begin_layout Plain Layout

	
\backslash
node (kinetics) [blokk, right=of thrust_configuration] {
\backslash
tiny Kinetics};
\end_layout

\begin_layout Plain Layout

	
\backslash
node (kinematics) [blokk, right=of kinetics] {
\backslash
tiny Kinematics};
\end_layout

\begin_layout Plain Layout

	
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
CSE1 diagram 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Actuators
\end_layout

\begin_layout Standard
Antall, posisjon, aktivert med pwm.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
begin{subfigure}{.3
\backslash
textwidth}
\end_layout

\begin_layout Plain Layout

 
\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
node[anchor=south west,inner sep=0] at (0,0) {
\end_layout

\end_inset


\begin_inset Graphics
	filename CSE1 actuators1.jpg
	width 70text%

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

};
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
caption{Hardware input}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig: Servo measurements-1"

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subfigure}
\end_layout

\begin_layout Plain Layout

~
\end_layout

\begin_layout Plain Layout


\backslash
begin{subfigure}{.3
\backslash
textwidth}
\end_layout

\begin_layout Plain Layout

 
\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
node[anchor=south west,inner sep=0] at (0,0) {
\end_layout

\end_inset


\begin_inset Graphics
	filename CSE1 actuators2.jpg
	width 70text%

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

};
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
caption{Control input}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig: Thruster configuration control input"

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subfigure}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Thruster configuration
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement h!
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="2">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt" special=">{\bfseries}l">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Port
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Component
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bow thruster motor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
VSP1 motor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
VSP2 motor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
not in use
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
servo1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
servo2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
servo3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
servo4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
CSE1 cRIO digital output
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset CommandInset label
LatexCommand label
name "tab: CSE1 cRIO digital out"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
50Hz.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: CSE1 cRIO digital out"

\end_inset


\end_layout

\begin_layout Standard
Motors motor control, servos directly.
\end_layout

\begin_layout Standard
PWM signals are found experimentally.
 Remeasure to account for wear and tear and flexibility.
\end_layout

\begin_layout Subsection
Motor control signals
\end_layout

\begin_layout Subsection
Servo control signals
\end_layout

\begin_layout Subsection
Measurements
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt" special=">{\bfseries}l">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Port
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Component
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
AI0
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6V Battery
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
AI1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Unknown
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
AI2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Unknown
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
AI3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12V Battery
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
CSE1 cRIO analog input
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset CommandInset label
LatexCommand label
name "tab: CSE1 analog inputs"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sub: CSE1 Control software"

\end_inset

Control software
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename CSE1_software_modules.png
	width 100text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
CSE1 control software modules
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: CSE1 control software"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
sixaxis (currently named WL_joystick) custom device
\end_layout

\begin_layout Standard
Reads sixaxis gamepad input from the RPi server.
\end_layout

\begin_layout Subsection
QTM (currently named Oqus) custom device
\end_layout

\begin_layout Standard
Reads pose (position and orientation) information broadcasted by Qualisys
 Track Manager.
 The data is in milimeters and degrees.
\end_layout

\begin_layout Standard
Additional outputs are
\end_layout

\begin_layout Itemize
a residual which is 0 for perfect measurement, increases with reduced quality
 of measurement and -1 for no measurement.
\end_layout

\begin_layout Itemize
an error code
\end_layout

\begin_layout Itemize
framecounter
\end_layout

\begin_layout Subsection
QTM2SI
\end_layout

\begin_layout Standard
Converts QTM data to standard international (SI) units: position in meters
 and orientation in radians.
 The yaw angle is mapped to the interval 
\begin_inset Formula $\psi\in\left[-\pi,\pi\right]$
\end_inset

.
\begin_inset Note Note
status open

\begin_layout Plain Layout
HOW?
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
ctrl_sixaxis2thruster control module
\end_layout

\begin_layout Standard
Provides manual thruster control.
\end_layout

\begin_layout Subsubsection
Voith Schneider Propellers
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename Sixaxis coordinate system.jpg
	width 50text%

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Sixaxis coordinate system
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: sixaxis coordinate system"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The left and right joysticks, repectively, give the VSP deflections, 
\begin_inset Formula $u_{\text{VSP1}}$
\end_inset

 and 
\begin_inset Formula $u_{\text{VSP2}}$
\end_inset

, and angles, 
\begin_inset Formula $\alpha_{\text{VSP1}}$
\end_inset

 and 
\begin_inset Formula $\alpha_{\text{VSP2}}$
\end_inset

, depicted in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Thruster configuration control input"

\end_inset

.
 The joystick coordinates PosX and PosY axes point right and down, as seen
 in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: sixaxis coordinate system"

\end_inset

.
 The deflection is
\begin_inset Formula 
\[
u_{\text{VSP}i}=\min\left(\sqrt{\left(\text{PosX}\right)^{2}+\left(\text{PosY}\right)^{2}},1\right).
\]

\end_inset

The 
\begin_inset Formula $\min\left(\cdot\right)$
\end_inset

 ensures contraining 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $u_{\text{VSP}i}\in\left[0,1\right]$
\end_inset

.
 The angle is
\begin_inset Formula 
\[
\alpha_{\text{VSP}i}=\arctan2\left(\text{PosX},-\text{PosY}\right).
\]

\end_inset


\end_layout

\begin_layout Standard
The VSP rotational speeds, 
\begin_inset Formula $\omega_{\text{VSP1}}$
\end_inset

 and 
\begin_inset Formula $\omega_{\text{VSP2}}$
\end_inset

, are set in 
\begin_inset Formula $\pm0.1$
\end_inset

 increments by use of the directional pad up and down buttons.
\begin_inset Note Note
status open

\begin_layout Plain Layout
HOW?
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Bow thruster
\end_layout

\begin_layout Standard
BT is controlled by L2 and R2.
 Both buttons output -1 when released and increasing to 1 when fully pushed.
 The thruster input
\begin_inset Formula 
\[
u_{\text{BT}}=-\frac{L2-R1}{2}
\]

\end_inset

maps to the interval 
\begin_inset Formula $u_{\text{BT}}\in\left[-1,1\right]$
\end_inset

 with positive direction according to Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Thruster configuration control input"

\end_inset

.
\end_layout

\begin_layout Subsection
ctrl_sixaxis2force control module
\end_layout

\begin_layout Standard
Provides manual forces and moment control.
 Surge and sway forces, X and Y, are given by the left joystick.
 Yaw moment N is given by the L2 and R2 buttons.
\end_layout

\begin_layout Standard
Thrust allocation is based on the configation shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Thruster configuration control input"

\end_inset

.
 The thrust is thus
\begin_inset Formula 
\[
\tau=T\left(\alpha\right)Ku
\]

\end_inset

where
\begin_inset Formula 
\begin{eqnarray*}
\tau & = & \left[\begin{array}{c}
X\\
Y\\
N
\end{array}\right]\text{ are the forces and moment},\\
T\left(\alpha\right) & = & \left[\begin{array}{ccc}
\cos\left(\alpha_{\text{VSP1}}\right) & \cos\left(\alpha_{\text{VSP2}}\right) & 0\\
\sin\left(\alpha_{\text{VSP1}}\right) & \sin\left(\alpha_{\text{VSP2}}\right) & 1\\
l_{x,\text{VSP1}}\cos\left(\alpha_{\text{VSP1}}\right)-l_{y,\text{VSP1}}\sin\left(\alpha_{\text{VSP1}}\right) & l_{x,\text{VSP2}}\cos\left(\alpha_{\text{VSP2}}\right)-l_{y,\text{VSP2}}\sin\left(\alpha_{\text{VSP2}}\right) & l_{\text{BT}}
\end{array}\right]\\
 &  & \text{is the configuration matrix,}\\
\alpha & = & \left[\begin{array}{c}
\alpha_{\text{VSP1}}\\
\alpha_{\text{VSP2}}
\end{array}\right]\text{ are the thruster angles},\\
K & = & \left[\begin{array}{ccc}
K_{\text{VSP1}} & 0 & 0\\
0 & K_{\text{VSP2}} & 0\\
0 & 0 & K_{\text{BT}}
\end{array}\right]\text{ is the force coefficient matrix, and}\\
u & = & \left[\begin{array}{c}
u_{\text{VSP1}}\\
u_{\text{VSP2}}\\
u_{\text{BT}}
\end{array}\right]\text{ are the control forces.}
\end{eqnarray*}

\end_inset

Since solving the thrust equation for 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $\alpha$
\end_inset

 is complicated, a virtual is azimuthing thruster VSP representing the joint
 forces from VSP1 and VSP2 is considered instead.
 It is further assumed that 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $\alpha_{\text{VSP1}}=\alpha_{\text{VSP2}}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none

\begin_inset Formula $K_{\text{VSP1}}=K_{\text{VSP2}}$
\end_inset

 and 
\begin_inset Formula $u_{\text{VSP1}}=u_{\text{VSP2}}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
.
 Considering an extended control force vector
\begin_inset Formula 
\[
u_{e}=\left[\begin{array}{c}
u_{\text{VSP},x}\\
u_{\text{VSP},y}\\
u_{\text{BT}}
\end{array}\right],
\]

\end_inset

where the VSP control forces are decomposed, yields
\begin_inset Formula 
\[
\underbrace{\left[\begin{array}{c}
X\\
Y\\
N
\end{array}\right]}_{\tau_{e}}=\underbrace{\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & 1 & 1\\
0 & l_{x,\text{VSP}} & l_{\text{BT}}
\end{array}\right]}_{T_{e}}\underbrace{\left[\begin{array}{ccc}
K_{\text{max,VSP}} & 0 & 0\\
0 & K_{\text{max,VSP}} & 0\\
0 & 0 & K_{\text{max,BT}}
\end{array}\right]}_{K_{e}}u_{e}.
\]

\end_inset

This is solved for 
\begin_inset Formula $u_{e}$
\end_inset

 by simple inversion.
 Finally, the actual control forces are
\begin_inset Formula 
\begin{eqnarray*}
u_{\text{VSP1}}=u_{\text{VSP2}} & = & \sqrt{\left(u_{\text{VSP},x}\right)^{2}+\left(u_{\text{VSP},y}\right)^{2}},\text{ and}\\
\alpha_{\text{VSP1}}=\alpha_{\text{VSP2}} & = & \text{arctan2}\left(u_{\text{VSP},y},u_{\text{VSP},x}\right).
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
ctrl_DP_basic control module
\end_layout

\begin_layout Standard
Provides basic dynamic positioning capability.
\end_layout

\begin_layout Subsection
ctrl_student control module
\end_layout

\begin_layout Standard
-
\end_layout

\begin_layout Subsection
switch module
\end_layout

\begin_layout Standard
Selects one out of four control modules
\end_layout

\begin_layout Itemize
ctrl_sixaxis2thruster when 
\begin_inset Graphics
	filename sixaxis_triangle.png
	scale 40

\end_inset

 is pushed
\end_layout

\begin_layout Itemize
ctrl_sixaxis2force when 
\begin_inset Graphics
	filename sixaxis_square.png
	scale 40

\end_inset

 is pushed
\end_layout

\begin_layout Itemize
ctrl_DP_basic when 
\begin_inset Graphics
	filename sixaxis_circle.png
	scale 40

\end_inset

 is pushed
\end_layout

\begin_layout Itemize
ctrl_student when 
\begin_inset Graphics
	filename sixaxis_cross.png
	scale 40

\end_inset

 is pushed
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
min
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
control input
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
max
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1\leq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
u_BT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\leq1$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0\leq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
u_VSP1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\leq1$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0\leq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
u_VSP2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\leq1$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-\pi\leq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
alpha_VSP1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\leq\pi$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-\pi\leq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
alpha_VSP2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\leq\pi$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1\leq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
omega_VSP1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\leq1$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1\leq$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
omega_VSP2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\leq1$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab: CSE1 control input ranges"

\end_inset

Control input ranges
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The module also saturates the control signals according to Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: CSE1 control input ranges"

\end_inset

 and issues a warning signal if the current controller exceedes the bounds.
\end_layout

\begin_layout Subsection
uao2pwm module
\end_layout

\begin_layout Standard
Converts the unitized controller inputs to signals suitable for pwm output
 to the ESC.
\end_layout

\begin_layout Standard
The position of the VSP steering rods are controlled by a pair of servos
 for each.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="5">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt" special=">{\bfseries}l">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<column alignment="left" valignment="top" width="0pt">
<row>
<cell multirow="3" alignment="left" valignment="middle" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Position
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
VSP1
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
VSP2
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
servo1 [%]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
servo2 [%]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
servo3 [%]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
servo4 [%]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
N
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.95
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.85
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.30
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.90
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
E
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.90
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.05
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.89
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.38
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SE
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.40
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.00
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
S
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.70
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.95
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.50
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SW
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.35
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.40
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
W
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.85
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
NW
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.60
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5.65
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.30
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Origo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.90
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.82
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4.52
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Servo pwm ranges
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset CommandInset label
LatexCommand label
name "tab: CSE1 servo ranges"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Ikke lineært, ikke rett frem.
\end_layout

\begin_layout Standard
Foreslått metode
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
centering
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
begin{subfigure}{.3
\backslash
textwidth}
\end_layout

\begin_layout Plain Layout

 
\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
node[anchor=south west,inner sep=0] at (0,0) {
\end_layout

\end_inset


\begin_inset Graphics
	filename CSE1 servo settings 1.jpg
	width 70text%

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

};
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
caption{Measurments}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig: Servo measurements"

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subfigure}
\end_layout

\begin_layout Plain Layout

~
\end_layout

\begin_layout Plain Layout


\backslash
begin{subfigure}{.3
\backslash
textwidth}
\end_layout

\begin_layout Plain Layout

 
\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
node[anchor=south west,inner sep=0] at (0,0) {
\end_layout

\end_inset


\begin_inset Graphics
	filename CSE1 servo settings 2.jpg
	width 70text%

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

};
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
caption{First interpolation and extrapolation}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig: Servo first extrapolation"

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subfigure}
\end_layout

\begin_layout Plain Layout

~
\end_layout

\begin_layout Plain Layout


\backslash
begin{subfigure}{.3
\backslash
textwidth}
\end_layout

\begin_layout Plain Layout

 
\backslash
centering
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout


\backslash
node[anchor=south west,inner sep=0] at (0,0) {
\end_layout

\end_inset


\begin_inset Graphics
	filename CSE1 servo settings 3.jpg
	width 70text%

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

};
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
caption{Second extrapolation}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig: Servo second extrapolation"

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{subfigure}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Servo, rod position tuning
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
FPGA interface
\end_layout

\begin_layout Standard
Outputs pwm signals through the digital output modules.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h!
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="2">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="left" valignment="top" width="0pt" special=">{\bfseries}l">
<column alignment="left" valignment="top" width="0pt" special=">{\bfseries}l">
<row>
<cell multicolumn="1" alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
uao2pwm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
FPGA
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{\text{pwm}}_{\text{BT}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{\text{pwm}}_{\text{VSP1}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{\text{pwm}}_{\text{VSP2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{\text{pwm}}_{\text{servo1}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{\text{pwm}}_{\text{servo2}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{\text{pwm}}_{\text{servo3}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{\text{pwm}}_{\text{servo4}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
pwm7
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
PWM connections
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset CommandInset label
LatexCommand label
name "tab:cRIO-actuator"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Qualisys body
\end_layout

\begin_layout Standard
calibration
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename qualisys_CSE1_frame.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Matlab console
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: matlab console-1-1"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "00 referencesl"
options "elsarticle-harv"

\end_inset


\end_layout

\begin_layout Part
\start_of_appendix
Miscellaneous 
\end_layout

\begin_layout Chapter
Simulation and control with cRIO
\end_layout

\begin_layout Section
Simulink model adaptation and compilation
\end_layout

\begin_layout Standard
Complete the following steps to convert your model you created in Simulink
 into a compiled model that runs on RT targets.
\end_layout

\begin_layout Standard
Version compatibility is an issue for VeriStand-Simulink interaction.
 Mostly
\begin_inset Foot
status open

\begin_layout Plain Layout
It has been experience that MATLAB function blocks are not compatible across
 versions.
 This results in build error message 
\begin_inset Quotes eld
\end_inset

invalid object ID
\begin_inset Quotes erd
\end_inset

.
 The MATLAB function block code must then be copied and pasted into a new
 MATLAB function block from the compatible version Simulink Library Browser.
\end_layout

\end_inset

 Simulink code may be programmed in any version of the MATLAB, compilation,
 on the other hand, can only be done in version compatible with the intended
 VeriStand version.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Laptop software"

\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub: Simulink modeling"

\end_inset

Modeling
\end_layout

\begin_layout Subsubsection
Input and output
\end_layout

\begin_layout Standard
In order for the model to interact with VeriStand, special input and output
 blocks must be added to the block diagram
\begin_inset Foot
status open

\begin_layout Plain Layout
Ordinary input/source and output/sink blocks could be used at the diagram
 top level.
 However, subsystem ports are only available when using the VeriStand blocks.
\end_layout

\end_inset

.
 These are found in the Simulink Library Browser under NI VeriStand Blocks.
\end_layout

\begin_layout Subsubsection
Initial conditions
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename simulink_integrator.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Integrator function block parameters
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: simulink integrator function block parameters"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
If the simulation is to be run with different initial conditions, one possible
 method is to allow external reset of the integrators.
 This is done right-click the integrator and selecting Block Parameters
 (Integrator) in the drop-down menu.
 Here, the reset condition is set.
 The initial condition source should be external, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: simulink integrator function block parameters"

\end_inset

.
\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Real-time-data-logging"

\end_inset

Real-time data logging
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename simulink_tofile.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
To File block parameters
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: simulink to file"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Model output can be saved to the cRIO, for later retrieval through FTP,
 during simulation through a To File block.
 This block is found in the Simulink Library Browser under Sinks.
 The output file name is specified under the block parameters, as in Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: simulink to file"

\end_inset

.
 The format should be set to Array, since the cRIO does not support the
 Timeseries format.
\end_layout

\begin_layout Paragraph
Example:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename simulink_before.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Simulink model for offline simulation
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: Simulink pendulum model"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename simulink_after.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Simulink model for adjusted for compilation
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: simulink pendulum model for compilation"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
For a simple pendulum, 
\begin_inset Formula $\dot{\omega}=-\frac{g}{l}\sin\left(\theta\right)-\frac{k}{ml^{2}}\omega+\frac{F_{\text{fan}}}{ml}\cos\left(\theta\right)$
\end_inset

, the offline simulation block diagram could look as Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: Simulink pendulum model"

\end_inset

.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: simulink pendulum model for compilation"

\end_inset

 shows the same system adapted for VeriStand input, including reset and
 initial conditions, and output.
 The VeriStand blocks are yellow.
 omega_0 and theta_0 are ports corresponding to the initial conditions 
\begin_inset Formula $\left(\omega\left(0\right),\theta\left(0\right)\right)$
\end_inset

.
 The integrators take these values whenever reset is rising or falling.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub: Simulink model configuration"

\end_inset

Model configuration
\end_layout

\begin_layout Standard
The code generation toolbox compiles the Simulink diagram to an output shared
 library in *.out format
\begin_inset Foot
status open

\begin_layout Plain Layout
The *.out format is for targets running Wind River VxWorks real-time operating
 system (RTOS) such as cRIO-9024, while dynamic link libraries in *.dll format
 are for targets running IntervalZero Phar Lap ETS RTOS such as cRIO-9081.
\end_layout

\end_inset

.
 Model configuration parameters must be adjusted before generating, or building,
 the code.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename simulink_settings_solver.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Simulink configuration parameters - solver
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: simulink solver"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The solver stop time should be 
\family typewriter
inf
\family default
 (infinity) if the model is supposed to run until it is otherwise interrupted.
 The solver type must be fixed step.
 If your model only performs arithmetical operations, such as a mapping
 or transformation module would, the discrete solver should be used.
 If the model contains continuous states, i.e.
 if you have integrators, choose some differential equation solver such
 as ode3 or ode4.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: simulink solver"

\end_inset

.
 Finally, the step size can be set: for a target running at 100 Hz, such
 as the cRIO-9024 default, a 0.01 step size results in the model running
 in simulating 1 second pr.
 second
\begin_inset Foot
status open

\begin_layout Plain Layout
This can also be achieved by use of decimation, as described in Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Veristand System-setup"

\end_inset

.
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename simulink_settings_codegeneration.jpg
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Simulink configuration parameters - target selection
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: simulink target selection"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The correct target file should be selected depending on the target device.
 Select 
\family typewriter
NIVeriStand_VxWorks.tlc
\family default
 for VxWorks targets
\begin_inset Foot
status open

\begin_layout Plain Layout
For PharLap targets, select 
\family typewriter
NIVeriStand.tlc
\family default
.
\end_layout

\end_inset

, such as cRIO-9024, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: simulink target selection"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename simulink_settings_ni.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Simulink model configuration - NI configuration
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: simulink NI configuration"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The WindRiver GNU Toolchain must be present in the folder specified under
 NI Configuration, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: simulink NI configuration"

\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub: Simulink model build"

\end_inset

Build
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename matlab_command.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
MATLAB console
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: matlab console"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The build output is placed in a subfolder in the MATLAB Current Folder.
 The desired folder must therefore be active in the MATLAB main window,
 as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: matlab console"

\end_inset

, before compiling.
 The build subfolder name is [simulink model name]_niVeriStand_VxWorks_rtw.
\end_layout

\begin_layout Standard
The build is done in in Simulink, either with the Build button in the configurat
ion window, by clicking the 
\begin_inset Graphics
	filename simulink_build.jpg
	scale 50

\end_inset

 button, by the key combination 
\noun on
Ctrl+B
\noun default
, through the menu Code 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textgreater 
\end_layout

\end_inset

 C/C++ Code 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textgreater 
\end_layout

\end_inset

 Build model, or by pushing the icon button.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Simulation configuration
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
VeriStand start screen
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Simulations are set up, deployed and interfaced through VeriStand.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand"

\end_inset

 shows the start screen.
 Already configured projects can be run directly from here, or reconfigured.
\end_layout

\begin_layout Subsection
Project creation
\end_layout

\begin_layout Standard
To deploy model for the first time, click New NI VeriStand Project.
 Give your new project a suitable name and location.
 
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand_projectexplorer.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
VeriStand Project Explorer
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand project explorer"

\end_inset

 
\end_layout

\end_inset

 Clicking OK creates the project files in given location and opens the Project
 Explorer, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand project explorer"

\end_inset

.
 In this section, the example project name is multiply.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub: Veristand System-setup"

\end_inset

System setup
\end_layout

\begin_layout Standard
To configure the setup which will run on the cRIO, open the System Explorer
 by double-clicking the system definition file [project name].nivssdf.
\end_layout

\begin_layout Enumerate
\begin_inset Float figure
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand_systemexplorer_ip.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
VeriStand - System Explorer - Controller
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand system explorer ip"

\end_inset

 
\end_layout

\end_inset

 Set the correct controller operating system and IP address, as in Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand system explorer ip"

\end_inset

.
 All HIL and MC lab IP addresses are given in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: IP addresses"

\end_inset

.
 Also, note the target rate.
\end_layout

\begin_layout Enumerate
\begin_inset Float figure
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand_systemexplorer.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
VeriStand - System Explorer - Models
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand system explorer model"

\end_inset

 
\end_layout

\end_inset

 Click Add a Simulation Model, as seen at the top of Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand system explorer model"

\end_inset

.
 
\begin_inset Float figure
placement h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand_systemexplorer_model.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
VeriStand - System Explorer Model
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand system explorer model 2"

\end_inset

 
\end_layout

\end_inset

 Browse to the output of the Simulink compilation, as seen in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand system explorer model 2"

\end_inset

.
 Finally, click Auto Select Decimation to make sure the model runs at the
 intended rate.
\begin_inset Newline newline
\end_inset

Repeat if several models should run simultaneously.
\end_layout

\begin_layout Enumerate
Add custom devices, such as network input, by right clicking the custom
 device pane and choosing the required device
\begin_inset Foot
status open

\begin_layout Plain Layout
If the required device is not present, refer to the device driver installation
 instructions in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Installing custom device driver"

\end_inset

.
\end_layout

\end_inset

.
 
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand custom driver select.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Custom device selection
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand system explorer custom device selection-1"

\end_inset

 
\end_layout

\end_inset

 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand system explorer custom device selection-1"

\end_inset

 shows an example with the Sixaxis (WL_Joystick) device.
 Upon selection, a subfolder with the device name appears in the tree with
 signals listed inside it.
\end_layout

\begin_layout Enumerate
Configure mappings, by pushing the 
\begin_inset Graphics
	filename veristand_sysex_mappingbtn.png
	scale 80

\end_inset

 icon at the top of the window, to connect signals between custom devices,
 FPGA and models.
\begin_inset Float figure
placement !h
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand mapping2.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
VeriStand System Configuration Mappings
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand mappings-1"

\end_inset

 
\end_layout

\end_inset

 Expand the trees to find the desired signals and click Connect, as in Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand mappings-1"

\end_inset

.
\end_layout

\begin_layout Enumerate
Save and close to return to the Project Explorer.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub: Create computer interface"

\end_inset

Create computer interface
\end_layout

\begin_layout Standard
To configure the computer interface, open the Workspace editor by double-clickin
g the workspace file [project name].nivsscreen.
 The blank workspace pops up.
\end_layout

\begin_layout Enumerate
Enter Edit mode by 
\noun on
Ctrl+M
\noun default
 or Screen 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textgreater 
\end_layout

\end_inset

 Edit Mode.
\end_layout

\begin_layout Enumerate
Click the Workspace Control pane on the left side to access indicators,
 controls and such.
\end_layout

\begin_layout Enumerate
Drag and drop the desired item to the desired position in the workspace.
 Select the corresponding signal in the pop-up dialog.
\end_layout

\begin_layout Enumerate
Close the Workspace editor.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Deployment and simulation
\end_layout

\begin_layout Subsection
Run
\end_layout

\begin_layout Standard
Deploy by tapping the F6 key, or 
\begin_inset Graphics
	filename veristand_deploy.jpg
	scale 80

\end_inset

 button, or Operate 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textgreater 
\end_layout

\end_inset

 Deploy.
 A dialog box appears.
 Upon successful deployment, the workspace pops up.
\end_layout

\begin_layout Subsection
User interface side data logging
\end_layout

\begin_layout Standard
For reliability, it is recommended to log data directly on the cRIO during
 simulation, as described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Real-time-data-logging"

\end_inset

.
 It is also possible to log via the laptop user interface.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand_ws_logging.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Logging Control
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand workspace logging control"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
A Logging Control, as seen in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand workspace logging control"

\end_inset

, must be added to the workspace to export data from the simulation.
 The control is added as described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub: Create computer interface"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand_ws_logging_file.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Logging Control file settings
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand workspace logging file"

\end_inset

 
\end_layout

\end_inset


\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename veristand_ws_logging_add_ch.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Logging Control add channel
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: veristand workspace logging channels"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Once the control is added, a pop-up window allows to edit the settings.
 The log file path is specified under File Settings, see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand workspace logging file"

\end_inset

.
 Under Channels, the desired channels can be selected and added, as in Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: veristand workspace logging channels"

\end_inset

.
\end_layout

\begin_layout Subsection
Stop
\end_layout

\begin_layout Standard
\begin_inset Graphics
	filename veristand_undeploy.jpg
	scale 80

\end_inset

 button
\end_layout

\begin_layout Subsection
FTP data retrieval
\end_layout

\begin_layout Standard
Data logged on the cRIO through To File blocks can be retrieved after simulation
 over FTP with software such as WinSCP.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename WinSCP_login.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: WinSCP login"

\end_inset

WinSCP login
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
To connect to the cRIO, the correct IP must be specified, as in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: WinSCP login"

\end_inset

.
 For the standard HIL setup, the user name and password are blank.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Graphics
	filename WinSCP.png
	scale 45

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig: WinSCP"

\end_inset

WinSCP
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Logged data with file names corresponding to the To File block names are
 located on the cRIO root, as seen in the right pane of Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig: WinSCP"

\end_inset

.
 Data is transferred to the laptop by drag and drop to the desired location
 in the left pane.
\end_layout

\begin_layout Chapter
Device network addresses
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="none" valignment="top" special=">{\bfseries}l">
<column alignment="left" valignment="top" width="2.4cm">
<column alignment="left" valignment="top" width="3cm">
<row>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Qualisys PCs
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.168.0.10
\end_layout

\begin_layout Plain Layout
192.168.0.20
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
surface
\end_layout

\begin_layout Plain Layout
underwater
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Laptops
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.168.0.41
\end_layout

\begin_layout Plain Layout
192.168.0.42
\end_layout

\begin_layout Plain Layout
192.168.0.43
\end_layout

\begin_layout Plain Layout
192.168.0.47
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
iimt-HILlab1-PC
\end_layout

\begin_layout Plain Layout
iimt-HILlab2-PC
\end_layout

\begin_layout Plain Layout
iimt-HILlab3-PC
\end_layout

\begin_layout Plain Layout
MClab
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MC Lab router
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.168.0.50
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SSID: MC Lab
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
RPi
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.168.1.22
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
for all
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cRIO primary ethernet
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.168.0.71
\end_layout

\begin_layout Plain Layout
192.168.0.72
\end_layout

\begin_layout Plain Layout
192.168.0.73
\end_layout

\begin_layout Plain Layout
192.168.0.76
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
iimt-HILlab1-cRIO
\end_layout

\begin_layout Plain Layout
iimt-HILlab2-cRIO
\end_layout

\begin_layout Plain Layout
iimt-HILlab3-cRIO
\end_layout

\begin_layout Plain Layout
CSE1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cRIO secondary ethernet
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
192.168.1.21
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
for all
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Assigned by DHCP
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
From
\end_layout

\begin_layout Plain Layout
192.168.0.100
\end_layout

\begin_layout Plain Layout
to
\end_layout

\begin_layout Plain Layout
192.168.0.254
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Subnet mask
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
255.255.255.0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
for all
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
IP addresses
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab: IP addresses"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
All RPis and have the same IP address, but there is no IP conflict since
 the cRIO-RPi networks are separate and closed.
 The same goes for the cRIO secondary ethernet ports 
\end_layout

\begin_layout Standard
Note: to connect the RPi directly to the computer, both need to be on the
 same domain and the computer IP thus needs to change to 192.168.
\series bold
1
\series default
.xx.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Chapter
ROV control modes
\end_layout

\begin_layout Section
ROV dynamics
\end_layout

\begin_layout Subsection
6 DOF model
\end_layout

\begin_layout Standard
We let the 6 DOF position/angle vector be 
\begin_inset Formula $\eta=\text{col}(p,\Theta)$
\end_inset

, where 
\begin_inset Formula $p=\text{col}(x,y,z)$
\end_inset

 and 
\begin_inset Formula $\Theta=\text{col}(\phi,\theta,\psi)$
\end_inset

, and the corresponding body-fixed velocity vector 
\begin_inset Formula $\nu=\text{col}(u,v,r,p,q,r)$
\end_inset

.
 The ROV kinematic model is then
\begin_inset Formula 
\begin{equation}
\dot{\eta}=J(\Theta)\nu.
\end{equation}

\end_inset

The kinetic control model is given 
\begin_inset space \space{}
\end_inset

by 
\begin_inset Formula 
\begin{equation}
M\dot{\nu}+C(\nu)\nu+D(\nu)\nu+g(\eta)=\tau+J(\Theta)^{-1}b(t),\label{Eq_6DOFdyn}
\end{equation}

\end_inset

where, in particular, 
\begin_inset Formula $M=M_{rb}+M_{a}$
\end_inset

 is the system inertia matrix, 
\begin_inset Formula $g(\eta)$
\end_inset

 is the restoring vector, and 
\begin_inset Formula $b(t)$
\end_inset

 is an external slowly varying bias vector.
 The thrust load vector is 
\begin_inset Formula 
\begin{equation}
\tau=\left[\begin{array}{c}
\mathcal{F}\\
\mathcal{M}
\end{array}\right],\qquad\mathcal{F}=\left[\begin{array}{c}
X\\
Y\\
Z
\end{array}\right]\left[\text{N}\right],\qquad\mathcal{M}=\left[\begin{array}{c}
K\\
M\\
N
\end{array}\right]\left[\text{Nm}\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
According to Fossen, if we assume starboard-port symmetry with 
\begin_inset Formula $y_{g}=I_{xy}=I_{yz}=I_{zx}=0,$
\end_inset

 then 
\begin_inset Formula $M$
\end_inset

 is given by 
\begin_inset Formula 
\begin{equation}
M=\left[\begin{array}{cccccc}
m-X_{\dot{u}} & 0 & -X_{\dot{w}} & 0 & mz_{g}-X_{\dot{q}} & 0\\
0 & m-Y_{\dot{v}} & 0 & -mz_{g}-Y_{\dot{p}} & 0 & mx_{g}-Y_{\dot{r}}\\
-X_{\dot{w}} & 0 & m-Z_{\dot{w}} & 0 & -mx_{g}-Z_{\dot{q}} & 0\\
0 & -mz_{g}-Y_{\dot{p}} & 0 & I_{x}-K_{\dot{p}} & 0 & -I_{zx}-K_{\dot{r}}\\
mz_{g}-X_{\dot{q}} & 0 & -mx_{g}-Z_{\dot{q}} & 0 & I_{y}-M_{\dot{q}} & 0\\
0 & mx_{g}-Y_{\dot{r}} & 0 & -I_{zx}-K_{\dot{r}} & 0 & I_{z}-N_{\dot{r}}
\end{array}\right].\label{Eq_M66}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Expressions for the Coriolis and centripetal matrix 
\begin_inset Formula $C(\nu)$
\end_inset

, and damping matrix 
\begin_inset Formula $D(\nu)$
\end_inset

, and restoring loads 
\begin_inset Formula $g(\eta)$
\end_inset

 can be found in Fossen.
\end_layout

\begin_layout Subsection
Thruster configuration
\end_layout

\begin_layout Standard
The thruster configuration for an ROV is given by a set of lever arms from
 the vessel origin (VO) to each individual thruster.
 For a single thruster, let the thrust vector it produces in the body frame,
 and its location in the body frame, be
\begin_inset Formula 
\begin{equation}
f=\left[\begin{array}{c}
f_{x}\\
f_{y}\\
f_{z}
\end{array}\right],\qquad l=\left[\begin{array}{c}
l_{x}\\
l_{y}\\
l_{z}
\end{array}\right],
\end{equation}

\end_inset

respectively.
 Then the corresponding thrust loads become 
\begin_inset Formula 
\begin{equation}
\tau=\left[\begin{array}{c}
f\\
l\times f
\end{array}\right]=\left[\begin{array}{c}
f_{x}\\
f_{y}\\
f_{z}\\
l_{y}f_{z}-l_{z}f_{y}\\
l_{z}f_{x}-l_{x}f_{z}\\
l_{x}f_{y}-l_{y}f_{x}
\end{array}\right].
\end{equation}

\end_inset

For a thruster producing thrust 
\begin_inset Formula $T$
\end_inset

 in pure surge direction becomes 
\begin_inset Formula $f=\text{col}(T,0,0)$
\end_inset

, pure sway becomes 
\begin_inset Formula $f=\text{col}(0,T,0)$
\end_inset

, and pure heave becomes 
\begin_inset Formula $f=\text{col}(0,0,T)$
\end_inset

.
 For an azimuth thruster producing thrust in surge-sway at an angle 
\begin_inset Formula $\alpha$
\end_inset

 becomes 
\begin_inset Formula $f=\text{col}(T\cos\alpha,T\sin\alpha,0)$
\end_inset

.
 For 
\begin_inset Formula $m$
\end_inset

 thrusters, each with an orientation 
\begin_inset Formula $\alpha_{i}$
\end_inset

, we get the total generalized thrust loads 
\begin_inset Formula 
\begin{equation}
\tau=\sum_{i=1}^{m}\tau_{i}=\sum_{i=1}^{m}\left[\begin{array}{c}
f_{i}\\
l_{i}\times f_{i}
\end{array}\right]=B(\alpha)Ku
\end{equation}

\end_inset

where 
\begin_inset Formula $B(\alpha)$
\end_inset

 is the thruster configuration matrix with 
\begin_inset Formula $\alpha=\text{col}(\alpha_{1},\ldots,\alpha_{m})$
\end_inset

, 
\begin_inset Formula $K=\text{diag}(k_{1},\ldots,k_{m})$
\end_inset

 is a matrix of scaling gains, and 
\begin_inset Formula $u=\text{col}(T_{1},\ldots,T_{m})$
\end_inset

 is the individual thruster forces (possibly normalized using the scaling
 in 
\begin_inset Formula $K$
\end_inset

).
\end_layout

\begin_layout Subsubsection
Example: Minerva
\end_layout

\begin_layout Standard
For ROV Minerva the thruster configuration is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "Fig_MinervaThrusters"

\end_inset

 (where 
\begin_inset Formula $f_{p}$
\end_inset

 should point in the opposite direction).
 
\begin_inset Float figure
placement ptbh
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
centering
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename Minerva_1.jpg
	width 40text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Thruster configuration for ROV Minerva.
 The thrust force 
\begin_inset Formula $f_{p}$
\end_inset

 should point in opposite direction.
 
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "Fig_MinervaThrusters"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Considering only the thrusters for the 3DOF horizontal motion, the thruster
 configuration is:
\end_layout

\begin_layout Itemize
T1: Aft starboard thruster.
\end_layout

\begin_layout Itemize
T2: Aft port thruster.
\end_layout

\begin_layout Itemize
T3: Bow thruster, lateral thrust in potitive y-direction.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="5">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Thruster
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Location [m]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Azimuth [
\begin_inset Formula $\textdegree$
\end_inset

]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Saturation [RPM]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Saturation [N]
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Thr1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $l_{1}=(-0.57,0.24)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\alpha_{2}=10\textdegree$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1450
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $[T_{1,\min},T_{1,\max}]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Thr2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $l_{2}=(-0.57,-0.24)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\alpha_{3}=-10\textdegree$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1450
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $[T_{2,\min},T_{2,\max}]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
Thr3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $l_{3}=(0.166,0)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\alpha_{1}=90\textdegree$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1450
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $[T_{3,\min},T_{3,\max}]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
ROV Minerva thruster data
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab: ROV Minerva thruster data"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
These thrusters data is given in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab: ROV Minerva thruster data"

\end_inset

.
\end_layout

\begin_layout Standard
With the generalized force/moment vector 
\begin_inset Formula $\tau:=\text{col}(\tau_{u},\tau_{v},\tau_{r})$
\end_inset

, and 
\begin_inset Formula $u=\text{col}(T_{1},T_{2},T_{3})$
\end_inset

 being the thrust force [N] from each thruster, this gives the following
 configuration 
\begin_inset Formula 
\begin{align}
\tau & =B(\alpha)u\\
B(\alpha) & =\left[\begin{array}{ccc}
\cos\alpha_{1} & \cos\alpha_{2} & \cos\alpha_{3}\\
\sin\alpha_{1} & \sin\alpha_{2} & \sin\alpha_{3}\\
l_{1x}\sin\alpha_{1}-l_{1y}\cos\alpha_{1} & l_{2x}\sin\alpha_{2}-l_{2y}\cos\alpha_{2} & l_{3x}\sin\alpha_{3}-l_{3y}\cos\alpha_{3}
\end{array}\right]\nonumber \\
 & =\left[\begin{array}{ccc}
0 & \cos\alpha_{2} & \cos\alpha_{3}\\
1 & \sin\alpha_{2} & \sin\alpha_{3}\\
l_{1x} & l_{2x}\sin\alpha_{2}-l_{2y}\cos\alpha_{2} & l_{3x}\sin\alpha_{3}-l_{3y}\cos\alpha_{3}
\end{array}\right].\nonumber 
\end{align}

\end_inset

The commanded thrust for 
\begin_inset Formula $(T_{1},T_{2},T_{3})$
\end_inset

, based a commanded generalized thrust load vector 
\begin_inset Formula $\tau_{c}$
\end_inset

, is then calculated by a 
\series bold
thrust allocation
\series default
 algorithm.
\end_layout

\begin_layout Section
ROV control modes
\end_layout

\begin_layout Standard
We have discussed control modes for an ROV.
 We typically have different input devices:
\end_layout

\begin_layout Itemize
Keyboard
\end_layout

\begin_layout Itemize
Joystick
\end_layout

\begin_layout Itemize
Touchscreen 
\end_layout

\begin_layout Standard
Each of these can be set up to control the ROV in a number of control modes.The
 proposed modes, open for debate, is the following:
\end_layout

\begin_layout Enumerate

\series bold
Direct Thruster Control:
\series default
 Direct command of individual thrusters.
\end_layout

\begin_layout Enumerate

\series bold
Direct Motion Control:
\series default
 Direct command of ROV motions, distinguishing between:
\end_layout

\begin_deeper
\begin_layout Enumerate

\series bold
Direct Body-relative motion:
\series default
 Direct command of motion relative to Body reference frame.
\end_layout

\begin_layout Enumerate

\series bold
Direct NED-relative motion:
\series default
 Direct control of motion relative to NED
\begin_inset space \space{}
\end_inset

reference frame.
\end_layout

\begin_layout Enumerate

\series bold
Direct User-relative motion:
\series default
 Direct control of motion relative to User
\begin_inset space \space{}
\end_inset

reference frame.
 
\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
Auto Control:
\series default
 Automatic control modes
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
AutoPos:
\series default
 Automatic control of 
\begin_inset Formula $(x,y)$
\end_inset

.
\end_layout

\begin_layout Itemize

\series bold
AutoDepth:
\series default
 Automatic control of 
\begin_inset Formula $(z)$
\end_inset

.
\end_layout

\begin_layout Itemize

\series bold
AutoHead:
\series default
 Automatic control of 
\begin_inset Formula $(\psi)$
\end_inset

.
\end_layout

\begin_layout Itemize

\series bold
CompRollPitch:
\series default
 Automatic compensation control of 
\begin_inset Formula $(\phi,\theta)$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
Indirect Motion Control:
\series default
 Instantaneously command a guidance filter and use feedback to automatically
 control the ROV correspondingly.
\end_layout

\begin_layout Enumerate

\series bold
Marine Operations Control:
\series default
 More complex modes specific for various marine operations of the ROV, such
 as:
\end_layout

\begin_deeper
\begin_layout Itemize
Waypoint tracking control
\end_layout

\begin_layout Itemize
Path-following
\end_layout

\begin_layout Itemize
...
 
\end_layout

\end_deeper
\begin_layout Standard
Typically in a motion control system it is possible to combine several of
 these modes, such that one can for instance use 
\emph on
Direct Motion Control
\emph default
 in horizontal position, while using AutoHead and AutoDepth.
 Other modes may not be possible to combine, since they may be in conflict.
 For instance, one should not combine the submodes 
\emph on
Direct Body-relative Motion Control
\emph default

\begin_inset space \space{}
\end_inset

with 
\emph on
Direct NED-relative Motion Control
\emph default

\begin_inset space \space{}
\end_inset

since these may come in conflict.
\begin_inset space \space{}
\end_inset

The user should therefore be given a mode 
\emph on
Direct Motion Control
\emph default

\begin_inset space \space{}
\end_inset

and a switch to select Body-, NED-, or User-relative submodes.
\begin_inset space \space{}
\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Direct-Thruster-Control"

\end_inset

Direct Thruster Control
\end_layout

\begin_layout Standard
Use the input device to directly command the individual thrust vector 
\begin_inset Formula 
\[
u=\text{col}\left(T_{1},T_{2},\ldots,T_{m}\right)=u_{cmd}.
\]

\end_inset


\end_layout

\begin_layout Subsection
Direct Body Motion Control
\end_layout

\begin_layout Standard
Direct Motion Control uses thrust allocation to enable the user to command
 motions of the fully actuated vehicle without need to consider individual
 thruster setting.
 Motions can be commanded relative to body-frame, NED-frame, or user-frame.
\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Direct-Body-relative-motion"

\end_inset

Direct Body-relative motion
\end_layout

\begin_layout Standard
Use the input device to command the generalized 
\series bold
body-relative
\series default
 thrust vector 
\begin_inset Formula 
\begin{equation}
\tau=\text{col}\left(\mathcal{F},\mathcal{M}\right)=\tau_{cmd}.
\end{equation}

\end_inset

Then use thrust allocation to calculate the corresponding individual commanded
 thrust vector, e.g.
 
\begin_inset Formula 
\begin{equation}
u_{cmd}=B(\alpha)^{\dagger}\tau_{cmd}.
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Direct-NED-relative-motion"

\end_inset

Direct NED-relative motion
\end_layout

\begin_layout Standard
Use the input device to command the generalized 
\series bold
NED-relative
\series default
 thrust vector 
\begin_inset Formula $\tau_{cmd}^{NED}$
\end_inset

.
\end_layout

\begin_layout Standard
Assuming we have the orientation vector 
\begin_inset Formula $\Theta$
\end_inset

 for the vehicle available, we use the NED-Body transformation to calculate
 the corresponding body-fixed thrust vector, i.e.
 
\begin_inset Formula 
\begin{equation}
\tau_{cmd}^{Body}=J(\Theta)^{-1}\tau_{cmd}^{NED}.
\end{equation}

\end_inset

Finally we allocate this thrust vector to the invidual thrusters, e.g.
 
\begin_inset Formula 
\begin{equation}
u_{cmd}=B(\alpha)^{\dagger}\tau_{cmd}^{Body}=B(\alpha)^{\dagger}J(\Theta)^{-1}\tau_{cmd}^{NED}.
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Direct-User-relative-motion"

\end_inset

Direct User-relative motion
\end_layout

\begin_layout Standard
Use the input device to command the generalized 
\series bold
User-relative
\series default
 thrust vector 
\begin_inset Formula $\tau_{cmd}^{User}$
\end_inset

.
\end_layout

\begin_layout Standard
Assuming we have the orientation vector 
\begin_inset Formula $\Theta_{User}$
\end_inset

 for the user relative to the NED-frame, we then calculate 
\begin_inset Formula 
\begin{equation}
\tau_{cmd}^{NED}=J(\Theta_{User})\tau_{cmd}^{User}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Then, with the orientation vector 
\begin_inset Formula $\Theta$
\end_inset

 for the vehicle available, we use the NED-Body transformation to calculate
 the corresponding body-fixed thrust vector, i.e.
 
\begin_inset Formula 
\begin{equation}
\tau_{cmd}^{Body}=J(\Theta)^{-1}\tau_{cmd}^{NED}=J(\Theta)^{-1}J(\Theta_{User})\tau_{cmd}^{User}.
\end{equation}

\end_inset

Finally we allocate this thrust vector to the invidual thrusters, e.g.
 
\begin_inset Formula 
\begin{equation}
u_{cmd}=B(\alpha)^{\dagger}\tau_{cmd}^{Body}=B(\alpha)^{\dagger}J(\Theta)^{-1}J(\Theta_{User})\tau_{cmd}^{User}.
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Auto-Control"

\end_inset

Auto Control
\end_layout

\begin_layout Standard
The automatic feedback control modes are proposed as:
\end_layout

\begin_layout Enumerate
AutoPos: Automatic control of 
\begin_inset Formula $(x,y)$
\end_inset

.
\end_layout

\begin_layout Enumerate
AutoDepth: Automatic control of 
\begin_inset Formula $(z)$
\end_inset

.
\end_layout

\begin_layout Enumerate
AutoHead: Automatic control of 
\begin_inset Formula $(\psi)$
\end_inset

.
\end_layout

\begin_layout Enumerate
CompRollPitch: Automatic control of 
\begin_inset Formula $(\phi,\theta)$
\end_inset

.
 
\end_layout

\begin_layout Standard
These submodes are self-explanatory.
 To be detailed in the student projects.
\end_layout

\begin_layout Subsection
Indirect Motion Control
\end_layout

\begin_layout Standard
The idea is that the input devices are used to instantaneously command positions
/velocities/accelerations, feed these through a reference filter or a guidance
 algorithm, and then use feedback to automatically control the ROV corresponding
ly.
\end_layout

\begin_layout Standard
Here we can be creative and try different options.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Marine-Operations-Control"

\end_inset

Marine Operations Control
\end_layout

\begin_layout Standard
These are a set of more complex control modes, typically combined from several
 of the different submodes, to give automatic functions that are important
 for different marine operations of the ROV.
 An example is Path Following, where a sophisicated path-generation algorithms
 and a guidance filter is combined with automatic control of 
\begin_inset Formula $(x,y)$
\end_inset

, 
\begin_inset Formula $(z)$
\end_inset

, and 
\begin_inset Formula $(\psi)$
\end_inset

, possibly while compensating 
\begin_inset Formula $(\phi,\theta)$
\end_inset

.
\end_layout

\begin_layout Chapter
Personel and literature
\end_layout

\begin_layout Section
Points of contact
\end_layout

\begin_layout Description
Håkon
\begin_inset space ~
\end_inset

Nødset
\begin_inset space ~
\end_inset

Skåtun Hakon.Nodset.Skatun@km.kongsberg.com, built CSE1
\end_layout

\begin_layout Description
Øivind
\begin_inset space ~
\end_inset

Kåre
\begin_inset space ~
\end_inset

Kjerstad Built CSE1.
\end_layout

\begin_layout Description
Torgeir
\begin_inset space ~
\end_inset

Wahl Custom devices (Qualisys client, Sixaxis client), Sixaxis RPi server
\end_layout

\begin_layout Description
Dinh
\begin_inset space ~
\end_inset

Nam
\begin_inset space ~
\end_inset

Tran oppryddingsarbeid
\end_layout

\begin_layout Description
Andreas
\begin_inset space ~
\end_inset

Orsten brukt mye, skrevet artikel om sleping av isberg
\end_layout

\begin_layout Description
Robert
\begin_inset space ~
\end_inset

Kanajus rkajanus@gmail.com brukt HIL-lab og Minerva
\end_layout

\begin_layout Description
Eirik
\begin_inset space ~
\end_inset

Valle Teaching assistant TMR4243, Sixaxis for RPi setup
\end_layout

\begin_layout Description
Andreas
\begin_inset space ~
\end_inset

Reason
\begin_inset space ~
\end_inset

Dahl andreas.r.dahl@ntnu.no, Laboratory assistant TMR4243
\end_layout

\begin_layout Description
Jostein
\begin_inset space ~
\end_inset

Follestad Teaching assistant TMR4243.
 Comprehensive CSE1 identification, including towing.
 CS1E HIL model.
\end_layout

\begin_layout Description
Fredrik
\begin_inset space ~
\end_inset

Sandved Teaching assistant TMR4243, Custom displays
\end_layout

\begin_layout Description
Tor
\begin_inset space ~
\end_inset

Kvestad
\begin_inset space ~
\end_inset

Idland Built CSS spring 2015.
\end_layout

\begin_layout Description
Trond
\begin_inset space ~
\end_inset

Innset Trond.Innset@marintek.sintef.no, cut out the CSS hull foam
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Chapter
Maintenance 
\end_layout

\begin_layout Standard

\shape italic
Oil VSP
\end_layout

\begin_layout Chapter
Suppliers
\end_layout

\begin_layout Standard
\begin_inset Float table
placement h!
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="2">
<features rotate="0" booktabs="true" tabularvalignment="middle">
<column alignment="none" valignment="top" special=">{\bfseries}l">
<column alignment="left" valignment="top" width="7cm">
<row>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Laptops 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dell
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
cRIO 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
National Instruments
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
VSP
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Thrusters were ordere at 
\begin_inset Flex Flex:URL
status collapsed

\begin_layout Plain Layout

www.cornwallmodelboats.co.uk/acatalog/voith_schottel.html
\end_layout

\end_inset

.
 Per 2014, availability is variable.
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Suppliers
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset CommandInset label
LatexCommand label
name "tab:POC-1"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
FloatBarrier
\end_layout

\end_inset


\end_layout

\end_body
\end_document
